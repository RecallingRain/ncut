2025-05-14 20:22:29,463 - INFO - 日志系统已初始化
2025-05-14 20:26:05,739 - INFO - 日志系统已初始化
2025-05-14 20:28:13,076 - INFO - 日志系统已初始化
2025-05-14 20:32:59,864 - INFO - 日志系统已初始化
2025-05-14 20:35:40,155 - INFO - 日志系统已初始化
2025-05-14 20:35:41,570 - INFO - Incoming request: POST /ml/detect
2025-05-14 20:35:41,571 - INFO - Received file: traffic_0.csv
2025-05-14 20:35:41,576 - INFO - Loaded DataFrame with 168 rows and 23 columns
2025-05-14 20:35:41,579 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 168 rows
2025-05-14 20:35:41,579 - INFO - Initializing KNN model and starting training
2025-05-14 20:35:41,582 - INFO - Model training completed
2025-05-14 20:35:41,582 - INFO - Starting anomaly predictions
2025-05-14 20:35:41,586 - INFO - Predicted anomalies for 9 out of 168 samples
2025-05-14 20:35:41,587 - INFO - Returning 9 anomaly indices
2025-05-14 20:35:41,587 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 20:35:44,653 - INFO - Incoming request: POST /ml/detect
2025-05-14 20:35:44,654 - INFO - Received file: traffic_0.csv
2025-05-14 20:35:44,655 - INFO - Loaded DataFrame with 168 rows and 23 columns
2025-05-14 20:35:44,656 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 168 rows
2025-05-14 20:35:44,656 - INFO - Initializing KNN model and starting training
2025-05-14 20:35:44,657 - INFO - Model training completed
2025-05-14 20:35:44,657 - INFO - Starting anomaly predictions
2025-05-14 20:35:44,660 - INFO - Predicted anomalies for 9 out of 168 samples
2025-05-14 20:35:44,660 - INFO - Returning 9 anomaly indices
2025-05-14 20:35:44,660 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 20:35:45,239 - INFO - Incoming request: POST /ml/detect
2025-05-14 20:35:45,240 - INFO - Received file: traffic_0.csv
2025-05-14 20:35:45,241 - INFO - Loaded DataFrame with 168 rows and 23 columns
2025-05-14 20:35:45,242 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 168 rows
2025-05-14 20:35:45,242 - INFO - Initializing KNN model and starting training
2025-05-14 20:35:45,243 - INFO - Model training completed
2025-05-14 20:35:45,243 - INFO - Starting anomaly predictions
2025-05-14 20:35:45,246 - INFO - Predicted anomalies for 9 out of 168 samples
2025-05-14 20:35:45,246 - INFO - Returning 9 anomaly indices
2025-05-14 20:35:45,246 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 20:35:45,656 - INFO - Incoming request: POST /ml/detect
2025-05-14 20:35:45,657 - INFO - Received file: traffic_0.csv
2025-05-14 20:35:45,661 - INFO - Loaded DataFrame with 168 rows and 23 columns
2025-05-14 20:35:45,662 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 168 rows
2025-05-14 20:35:45,662 - INFO - Initializing KNN model and starting training
2025-05-14 20:35:45,664 - INFO - Model training completed
2025-05-14 20:35:45,664 - INFO - Starting anomaly predictions
2025-05-14 20:35:45,671 - INFO - Predicted anomalies for 9 out of 168 samples
2025-05-14 20:35:45,671 - INFO - Returning 9 anomaly indices
2025-05-14 20:35:45,671 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 20:35:45,975 - INFO - Incoming request: POST /ml/detect
2025-05-14 20:35:45,975 - INFO - Received file: traffic_0.csv
2025-05-14 20:35:45,977 - INFO - Loaded DataFrame with 168 rows and 23 columns
2025-05-14 20:35:45,977 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 168 rows
2025-05-14 20:35:45,977 - INFO - Initializing KNN model and starting training
2025-05-14 20:35:45,978 - INFO - Model training completed
2025-05-14 20:35:45,978 - INFO - Starting anomaly predictions
2025-05-14 20:35:45,982 - INFO - Predicted anomalies for 9 out of 168 samples
2025-05-14 20:35:45,983 - INFO - Returning 9 anomaly indices
2025-05-14 20:35:45,983 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 20:37:22,181 - INFO - Incoming request: POST /ml/detect
2025-05-14 20:37:22,184 - INFO - Received file: traffic_0.csv
2025-05-14 20:37:22,192 - INFO - Loaded DataFrame with 1065 rows and 25 columns
2025-05-14 20:37:22,192 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 1065 rows
2025-05-14 20:37:22,192 - INFO - Initializing KNN model and starting training
2025-05-14 20:37:22,196 - INFO - Model training completed
2025-05-14 20:37:22,196 - INFO - Starting anomaly predictions
2025-05-14 20:37:22,221 - INFO - Predicted anomalies for 90 out of 1065 samples
2025-05-14 20:37:22,221 - INFO - Returning 90 anomaly indices
2025-05-14 20:37:22,221 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 20:47:19,677 - INFO - 日志系统已初始化
2025-05-14 20:47:28,879 - INFO - Incoming request: POST /ml/detect
2025-05-14 20:47:28,881 - INFO - Received file: traffic_0.csv
2025-05-14 20:47:28,887 - INFO - Loaded DataFrame with 1065 rows and 25 columns
2025-05-14 20:47:28,887 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 1065 rows
2025-05-14 20:47:28,887 - INFO - Initializing KNN model and starting training
2025-05-14 20:47:28,890 - INFO - Model decision threshold: 170.95028517096307
2025-05-14 20:47:28,890 - INFO - Decision scores summary – min: 0.0, max: 4062.0011078844645, mean: 152.6515172076541
2025-05-14 20:47:28,890 - INFO - Sample index 0 flagged with score 174.80846661418352
2025-05-14 20:47:28,890 - INFO - Sample index 31 flagged with score 170.9502851709639
2025-05-14 20:47:28,890 - INFO - Sample index 36 flagged with score 170.9502851709639
2025-05-14 20:47:28,890 - INFO - Sample index 56 flagged with score 247.4449433712528
2025-05-14 20:47:28,890 - INFO - Sample index 61 flagged with score 209.40391593802855
2025-05-14 20:47:28,890 - INFO - Sample index 62 flagged with score 247.444943371253
2025-05-14 20:47:28,890 - INFO - Sample index 64 flagged with score 207.33065381217133
2025-05-14 20:47:28,890 - INFO - Sample index 73 flagged with score 235.45063176811
2025-05-14 20:47:28,890 - INFO - Sample index 75 flagged with score 219.33080041385531
2025-05-14 20:47:28,890 - INFO - Sample index 89 flagged with score 219.0935873091861
2025-05-14 20:47:28,890 - INFO - Sample index 93 flagged with score 219.3855054464818
2025-05-14 20:47:28,890 - INFO - Sample index 95 flagged with score 180.1027484987903
2025-05-14 20:47:28,890 - INFO - Sample index 97 flagged with score 178.06178714665438
2025-05-14 20:47:28,890 - INFO - Sample index 127 flagged with score 219.0935873119886
2025-05-14 20:47:28,890 - INFO - Sample index 173 flagged with score 411.52035186612335
2025-05-14 20:47:28,890 - INFO - Sample index 176 flagged with score 426.3472762969387
2025-05-14 20:47:28,890 - INFO - Sample index 203 flagged with score 402.04104268327137
2025-05-14 20:47:28,890 - INFO - Sample index 265 flagged with score 503.0039761274366
2025-05-14 20:47:28,890 - INFO - Sample index 266 flagged with score 562.918288919459
2025-05-14 20:47:28,890 - INFO - Sample index 270 flagged with score 170.9502851709639
2025-05-14 20:47:28,890 - INFO - Sample index 272 flagged with score 603.8824388902199
2025-05-14 20:47:28,890 - INFO - Sample index 281 flagged with score 530.144320696804
2025-05-14 20:47:28,890 - INFO - Sample index 282 flagged with score 398.2122549595881
2025-05-14 20:47:28,890 - INFO - Sample index 283 flagged with score 464.1723817762634
2025-05-14 20:47:28,890 - INFO - Sample index 284 flagged with score 332.2709737548557
2025-05-14 20:47:28,890 - INFO - Sample index 289 flagged with score 442.0384607853002
2025-05-14 20:47:28,890 - INFO - Sample index 292 flagged with score 574.0496494525898
2025-05-14 20:47:28,890 - INFO - Sample index 483 flagged with score 215.41587685791606
2025-05-14 20:47:28,890 - INFO - Sample index 484 flagged with score 220.11815009353592
2025-05-14 20:47:28,890 - INFO - Sample index 485 flagged with score 291.2112635361217
2025-05-14 20:47:28,890 - INFO - Sample index 486 flagged with score 845.7972570303122
2025-05-14 20:47:28,890 - INFO - Sample index 487 flagged with score 966.5334966367307
2025-05-14 20:47:28,890 - INFO - Sample index 488 flagged with score 1392.383208791767
2025-05-14 20:47:28,890 - INFO - Sample index 489 flagged with score 1512.492314245405
2025-05-14 20:47:28,890 - INFO - Sample index 490 flagged with score 1354.0003692761682
2025-05-14 20:47:28,890 - INFO - Sample index 491 flagged with score 1851.461044688954
2025-05-14 20:47:28,890 - INFO - Sample index 492 flagged with score 2752.451997764902
2025-05-14 20:47:28,890 - INFO - Sample index 509 flagged with score 4062.0011078844645
2025-05-14 20:47:28,890 - INFO - Sample index 511 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 512 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 513 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 515 flagged with score 4062.001107828637
2025-05-14 20:47:28,890 - INFO - Sample index 517 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 518 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 519 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 520 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 521 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 522 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 523 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 524 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 525 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 526 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 527 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 528 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 529 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 530 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 531 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 555 flagged with score 170.95028517188985
2025-05-14 20:47:28,890 - INFO - Sample index 557 flagged with score 4062.0011078293523
2025-05-14 20:47:28,890 - INFO - Sample index 558 flagged with score 4062.0011078285047
2025-05-14 20:47:28,890 - INFO - Sample index 560 flagged with score 4062.001107829121
2025-05-14 20:47:28,890 - INFO - Sample index 561 flagged with score 3491.756434804696
2025-05-14 20:47:28,890 - INFO - Sample index 562 flagged with score 1585.744304883969
2025-05-14 20:47:28,890 - INFO - Sample index 563 flagged with score 2560.5329524348226
2025-05-14 20:47:28,890 - INFO - Sample index 564 flagged with score 399.82621224913544
2025-05-14 20:47:28,890 - INFO - Sample index 565 flagged with score 722.8872664537828
2025-05-14 20:47:28,890 - INFO - Sample index 568 flagged with score 411.97694111556217
2025-05-14 20:47:28,890 - INFO - Sample index 580 flagged with score 235.45063176811
2025-05-14 20:47:28,890 - INFO - Sample index 581 flagged with score 219.33080041385188
2025-05-14 20:47:28,890 - INFO - Sample index 584 flagged with score 346.34087271023037
2025-05-14 20:47:28,890 - INFO - Sample index 585 flagged with score 314.2626290316362
2025-05-14 20:47:28,890 - INFO - Sample index 588 flagged with score 280.8789776660674
2025-05-14 20:47:28,890 - INFO - Sample index 589 flagged with score 215.7498554894442
2025-05-14 20:47:28,890 - INFO - Sample index 590 flagged with score 241.35658362726937
2025-05-14 20:47:28,890 - INFO - Sample index 597 flagged with score 346.34087271023037
2025-05-14 20:47:28,890 - INFO - Sample index 618 flagged with score 451.80194799198927
2025-05-14 20:47:28,890 - INFO - Sample index 621 flagged with score 219.09358730918728
2025-05-14 20:47:28,890 - INFO - Sample index 639 flagged with score 196.0102038160259
2025-05-14 20:47:28,890 - INFO - Sample index 640 flagged with score 339.8882169184451
2025-05-14 20:47:28,890 - INFO - Sample index 641 flagged with score 1025.473061567197
2025-05-14 20:47:28,890 - INFO - Sample index 642 flagged with score 340.03676340226605
2025-05-14 20:47:28,890 - INFO - Sample index 667 flagged with score 1122.3595681288252
2025-05-14 20:47:28,890 - INFO - Sample index 679 flagged with score 235.45063176811
2025-05-14 20:47:28,890 - INFO - Sample index 680 flagged with score 846.193831227068
2025-05-14 20:47:28,890 - INFO - Sample index 681 flagged with score 1317.1488146750921
2025-05-14 20:47:28,890 - INFO - Sample index 682 flagged with score 1600.2452938569302
2025-05-14 20:47:28,890 - INFO - Sample index 683 flagged with score 179.84715733297284
2025-05-14 20:47:28,891 - INFO - Sample index 684 flagged with score 260.75659147950313
2025-05-14 20:47:28,891 - INFO - Sample index 697 flagged with score 1886.2470675923428
2025-05-14 20:47:28,891 - INFO - Sample index 699 flagged with score 1934.9937984979613
2025-05-14 20:47:28,891 - INFO - Sample index 707 flagged with score 406.7689762072037
2025-05-14 20:47:28,891 - INFO - Sample index 820 flagged with score 228.3440386817856
2025-05-14 20:47:28,891 - INFO - Sample index 822 flagged with score 297.08416682594145
2025-05-14 20:47:28,891 - INFO - Sample index 847 flagged with score 196.0102038160259
2025-05-14 20:47:28,891 - INFO - Sample index 849 flagged with score 186.46179233290675
2025-05-14 20:47:28,891 - INFO - Sample index 851 flagged with score 822.280973888563
2025-05-14 20:47:28,891 - INFO - Sample index 862 flagged with score 218.2773465208666
2025-05-14 20:47:28,891 - INFO - Sample index 863 flagged with score 184.24440322836733
2025-05-14 20:47:28,891 - INFO - Sample index 948 flagged with score 240.01875049792983
2025-05-14 20:47:28,891 - INFO - Sample index 968 flagged with score 203.4305778434274
2025-05-14 20:47:28,891 - INFO - Sample index 974 flagged with score 271.18997161538533
2025-05-14 20:47:28,891 - INFO - Sample index 983 flagged with score 295.95607784058853
2025-05-14 20:47:28,891 - INFO - Sample index 987 flagged with score 401.01371547919723
2025-05-14 20:47:28,891 - INFO - Sample index 998 flagged with score 271.18997161538533
2025-05-14 20:47:28,891 - INFO - Sample index 1006 flagged with score 349.03581569577574
2025-05-14 20:47:28,891 - INFO - Sample index 1018 flagged with score 404.536773883704
2025-05-14 20:47:28,891 - INFO - Sample index 1029 flagged with score 458.36557618986365
2025-05-14 20:47:28,891 - INFO - Model training completed
2025-05-14 20:47:28,891 - INFO - Starting anomaly predictions
2025-05-14 20:47:28,912 - INFO - Predictions array (0 normal, 1 anomaly): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2025-05-14 20:47:28,912 - INFO - Predicted anomalies for 90 out of 1065 samples
2025-05-14 20:47:28,912 - INFO - Returning 90 anomaly indices
2025-05-14 20:47:28,912 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 20:58:34,982 - INFO - 日志系统已初始化
2025-05-14 20:58:46,321 - INFO - Incoming request: POST /ml/detect
2025-05-14 20:58:46,324 - INFO - Received file: traffic_0.csv
2025-05-14 20:58:46,333 - INFO - Loaded DataFrame with 1065 rows and 25 columns
2025-05-14 20:58:46,334 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 1065 rows
2025-05-14 20:58:46,338 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_205846.csv
2025-05-14 20:58:46,338 - INFO - Initializing KNN model and starting training
2025-05-14 20:58:46,341 - INFO - Model decision threshold: 170.95028517096307
2025-05-14 20:58:46,342 - INFO - Decision scores summary – min: 0.0, max: 4062.0011078844645, mean: 152.6515172076541
2025-05-14 20:58:46,342 - INFO - Sample index 0 flagged with score 174.80846661418352
2025-05-14 20:58:46,342 - INFO - Sample index 31 flagged with score 170.9502851709639
2025-05-14 20:58:46,342 - INFO - Sample index 36 flagged with score 170.9502851709639
2025-05-14 20:58:46,342 - INFO - Sample index 56 flagged with score 247.4449433712528
2025-05-14 20:58:46,342 - INFO - Sample index 61 flagged with score 209.40391593802855
2025-05-14 20:58:46,342 - INFO - Sample index 62 flagged with score 247.444943371253
2025-05-14 20:58:46,342 - INFO - Sample index 64 flagged with score 207.33065381217133
2025-05-14 20:58:46,342 - INFO - Sample index 73 flagged with score 235.45063176811
2025-05-14 20:58:46,342 - INFO - Sample index 75 flagged with score 219.33080041385531
2025-05-14 20:58:46,342 - INFO - Sample index 89 flagged with score 219.0935873091861
2025-05-14 20:58:46,342 - INFO - Sample index 93 flagged with score 219.3855054464818
2025-05-14 20:58:46,342 - INFO - Sample index 95 flagged with score 180.1027484987903
2025-05-14 20:58:46,342 - INFO - Sample index 97 flagged with score 178.06178714665438
2025-05-14 20:58:46,342 - INFO - Sample index 127 flagged with score 219.0935873119886
2025-05-14 20:58:46,342 - INFO - Sample index 173 flagged with score 411.52035186612335
2025-05-14 20:58:46,342 - INFO - Sample index 176 flagged with score 426.3472762969387
2025-05-14 20:58:46,342 - INFO - Sample index 203 flagged with score 402.04104268327137
2025-05-14 20:58:46,342 - INFO - Sample index 265 flagged with score 503.0039761274366
2025-05-14 20:58:46,342 - INFO - Sample index 266 flagged with score 562.918288919459
2025-05-14 20:58:46,342 - INFO - Sample index 270 flagged with score 170.9502851709639
2025-05-14 20:58:46,342 - INFO - Sample index 272 flagged with score 603.8824388902199
2025-05-14 20:58:46,342 - INFO - Sample index 281 flagged with score 530.144320696804
2025-05-14 20:58:46,342 - INFO - Sample index 282 flagged with score 398.2122549595881
2025-05-14 20:58:46,342 - INFO - Sample index 283 flagged with score 464.1723817762634
2025-05-14 20:58:46,342 - INFO - Sample index 284 flagged with score 332.2709737548557
2025-05-14 20:58:46,342 - INFO - Sample index 289 flagged with score 442.0384607853002
2025-05-14 20:58:46,342 - INFO - Sample index 292 flagged with score 574.0496494525898
2025-05-14 20:58:46,342 - INFO - Sample index 483 flagged with score 215.41587685791606
2025-05-14 20:58:46,342 - INFO - Sample index 484 flagged with score 220.11815009353592
2025-05-14 20:58:46,342 - INFO - Sample index 485 flagged with score 291.2112635361217
2025-05-14 20:58:46,342 - INFO - Sample index 486 flagged with score 845.7972570303122
2025-05-14 20:58:46,342 - INFO - Sample index 487 flagged with score 966.5334966367307
2025-05-14 20:58:46,342 - INFO - Sample index 488 flagged with score 1392.383208791767
2025-05-14 20:58:46,342 - INFO - Sample index 489 flagged with score 1512.492314245405
2025-05-14 20:58:46,342 - INFO - Sample index 490 flagged with score 1354.0003692761682
2025-05-14 20:58:46,342 - INFO - Sample index 491 flagged with score 1851.461044688954
2025-05-14 20:58:46,342 - INFO - Sample index 492 flagged with score 2752.451997764902
2025-05-14 20:58:46,342 - INFO - Sample index 509 flagged with score 4062.0011078844645
2025-05-14 20:58:46,342 - INFO - Sample index 511 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 512 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 513 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 515 flagged with score 4062.001107828637
2025-05-14 20:58:46,342 - INFO - Sample index 517 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 518 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 519 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 520 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 521 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 522 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 523 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 524 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 525 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 526 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 527 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 528 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 529 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 530 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 531 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 555 flagged with score 170.95028517188985
2025-05-14 20:58:46,342 - INFO - Sample index 557 flagged with score 4062.0011078293523
2025-05-14 20:58:46,342 - INFO - Sample index 558 flagged with score 4062.0011078285047
2025-05-14 20:58:46,342 - INFO - Sample index 560 flagged with score 4062.001107829121
2025-05-14 20:58:46,342 - INFO - Sample index 561 flagged with score 3491.756434804696
2025-05-14 20:58:46,342 - INFO - Sample index 562 flagged with score 1585.744304883969
2025-05-14 20:58:46,342 - INFO - Sample index 563 flagged with score 2560.5329524348226
2025-05-14 20:58:46,342 - INFO - Sample index 564 flagged with score 399.82621224913544
2025-05-14 20:58:46,343 - INFO - Sample index 565 flagged with score 722.8872664537828
2025-05-14 20:58:46,343 - INFO - Sample index 568 flagged with score 411.97694111556217
2025-05-14 20:58:46,343 - INFO - Sample index 580 flagged with score 235.45063176811
2025-05-14 20:58:46,343 - INFO - Sample index 581 flagged with score 219.33080041385188
2025-05-14 20:58:46,343 - INFO - Sample index 584 flagged with score 346.34087271023037
2025-05-14 20:58:46,343 - INFO - Sample index 585 flagged with score 314.2626290316362
2025-05-14 20:58:46,343 - INFO - Sample index 588 flagged with score 280.8789776660674
2025-05-14 20:58:46,343 - INFO - Sample index 589 flagged with score 215.7498554894442
2025-05-14 20:58:46,343 - INFO - Sample index 590 flagged with score 241.35658362726937
2025-05-14 20:58:46,343 - INFO - Sample index 597 flagged with score 346.34087271023037
2025-05-14 20:58:46,343 - INFO - Sample index 618 flagged with score 451.80194799198927
2025-05-14 20:58:46,343 - INFO - Sample index 621 flagged with score 219.09358730918728
2025-05-14 20:58:46,343 - INFO - Sample index 639 flagged with score 196.0102038160259
2025-05-14 20:58:46,343 - INFO - Sample index 640 flagged with score 339.8882169184451
2025-05-14 20:58:46,343 - INFO - Sample index 641 flagged with score 1025.473061567197
2025-05-14 20:58:46,343 - INFO - Sample index 642 flagged with score 340.03676340226605
2025-05-14 20:58:46,343 - INFO - Sample index 667 flagged with score 1122.3595681288252
2025-05-14 20:58:46,343 - INFO - Sample index 679 flagged with score 235.45063176811
2025-05-14 20:58:46,343 - INFO - Sample index 680 flagged with score 846.193831227068
2025-05-14 20:58:46,343 - INFO - Sample index 681 flagged with score 1317.1488146750921
2025-05-14 20:58:46,343 - INFO - Sample index 682 flagged with score 1600.2452938569302
2025-05-14 20:58:46,343 - INFO - Sample index 683 flagged with score 179.84715733297284
2025-05-14 20:58:46,343 - INFO - Sample index 684 flagged with score 260.75659147950313
2025-05-14 20:58:46,343 - INFO - Sample index 697 flagged with score 1886.2470675923428
2025-05-14 20:58:46,343 - INFO - Sample index 699 flagged with score 1934.9937984979613
2025-05-14 20:58:46,343 - INFO - Sample index 707 flagged with score 406.7689762072037
2025-05-14 20:58:46,343 - INFO - Sample index 820 flagged with score 228.3440386817856
2025-05-14 20:58:46,343 - INFO - Sample index 822 flagged with score 297.08416682594145
2025-05-14 20:58:46,343 - INFO - Sample index 847 flagged with score 196.0102038160259
2025-05-14 20:58:46,343 - INFO - Sample index 849 flagged with score 186.46179233290675
2025-05-14 20:58:46,343 - INFO - Sample index 851 flagged with score 822.280973888563
2025-05-14 20:58:46,343 - INFO - Sample index 862 flagged with score 218.2773465208666
2025-05-14 20:58:46,343 - INFO - Sample index 863 flagged with score 184.24440322836733
2025-05-14 20:58:46,343 - INFO - Sample index 948 flagged with score 240.01875049792983
2025-05-14 20:58:46,343 - INFO - Sample index 968 flagged with score 203.4305778434274
2025-05-14 20:58:46,343 - INFO - Sample index 974 flagged with score 271.18997161538533
2025-05-14 20:58:46,343 - INFO - Sample index 983 flagged with score 295.95607784058853
2025-05-14 20:58:46,343 - INFO - Sample index 987 flagged with score 401.01371547919723
2025-05-14 20:58:46,343 - INFO - Sample index 998 flagged with score 271.18997161538533
2025-05-14 20:58:46,343 - INFO - Sample index 1006 flagged with score 349.03581569577574
2025-05-14 20:58:46,343 - INFO - Sample index 1018 flagged with score 404.536773883704
2025-05-14 20:58:46,343 - INFO - Sample index 1029 flagged with score 458.36557618986365
2025-05-14 20:58:46,343 - INFO - Model training completed
2025-05-14 20:58:46,343 - INFO - Starting anomaly predictions
2025-05-14 20:58:46,369 - INFO - Predictions array (0 normal, 1 anomaly): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 1, 1, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2025-05-14 20:58:46,369 - INFO - Predicted anomalies for 90 out of 1065 samples
2025-05-14 20:58:46,369 - INFO - Returning 90 anomaly indices
2025-05-14 20:58:46,369 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 20:59:35,037 - INFO - Incoming request: POST /ml/detect
2025-05-14 20:59:35,038 - INFO - Received file: traffic_0.csv
2025-05-14 20:59:35,040 - INFO - Loaded DataFrame with 168 rows and 23 columns
2025-05-14 20:59:35,041 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 168 rows
2025-05-14 20:59:35,042 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_205935.csv
2025-05-14 20:59:35,042 - INFO - Initializing KNN model and starting training
2025-05-14 20:59:35,043 - INFO - Model decision threshold: 712.3621458715553
2025-05-14 20:59:35,043 - INFO - Decision scores summary – min: 2.9087066650390625e-05, max: 1377.2777497658196, mean: 180.14205502625506
2025-05-14 20:59:35,043 - INFO - Sample index 3 flagged with score 823.0218709125478
2025-05-14 20:59:35,043 - INFO - Sample index 41 flagged with score 1090.1545761977063
2025-05-14 20:59:35,043 - INFO - Sample index 42 flagged with score 907.4458661549432
2025-05-14 20:59:35,043 - INFO - Sample index 43 flagged with score 985.9462459992433
2025-05-14 20:59:35,043 - INFO - Sample index 53 flagged with score 739.9304069559014
2025-05-14 20:59:35,043 - INFO - Sample index 54 flagged with score 1072.7711778380421
2025-05-14 20:59:35,043 - INFO - Sample index 77 flagged with score 736.0061187859354
2025-05-14 20:59:35,043 - INFO - Sample index 78 flagged with score 869.0851512004157
2025-05-14 20:59:35,043 - INFO - Sample index 79 flagged with score 1087.0975117256041
2025-05-14 20:59:35,043 - INFO - Sample index 124 flagged with score 838.0214794384939
2025-05-14 20:59:35,043 - INFO - Sample index 125 flagged with score 728.8058726437376
2025-05-14 20:59:35,043 - INFO - Sample index 126 flagged with score 1075.3208823416428
2025-05-14 20:59:35,043 - INFO - Sample index 127 flagged with score 895.963168885867
2025-05-14 20:59:35,043 - INFO - Sample index 147 flagged with score 1031.7238002488846
2025-05-14 20:59:35,043 - INFO - Sample index 148 flagged with score 1033.73158992302
2025-05-14 20:59:35,043 - INFO - Sample index 149 flagged with score 1377.2777497658196
2025-05-14 20:59:35,043 - INFO - Sample index 153 flagged with score 944.9047588758764
2025-05-14 20:59:35,043 - INFO - Model training completed
2025-05-14 20:59:35,043 - INFO - Starting anomaly predictions
2025-05-14 20:59:35,048 - INFO - Predictions array (0 normal, 1 anomaly): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2025-05-14 20:59:35,048 - INFO - Predicted anomalies for 9 out of 168 samples
2025-05-14 20:59:35,048 - INFO - Returning 9 anomaly indices
2025-05-14 20:59:35,049 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 21:10:49,017 - INFO - 日志系统已初始化
2025-05-14 21:11:01,434 - INFO - 日志系统已初始化
2025-05-14 21:11:09,651 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:11:09,652 - INFO - Received file: traffic_0.csv
2025-05-14 21:11:09,654 - INFO - Loaded DataFrame with 168 rows and 23 columns
2025-05-14 21:11:09,655 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 168 rows
2025-05-14 21:11:09,656 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_211109.csv
2025-05-14 21:11:09,656 - INFO - Initializing KNN model and starting training
2025-05-14 21:11:09,658 - INFO - Model decision threshold: 712.3621458715553
2025-05-14 21:11:09,658 - INFO - Decision scores summary – min: 2.9087066650390625e-05, max: 1377.2777497658196, mean: 180.14205502625506
2025-05-14 21:11:09,658 - INFO - Sample index 3 flagged with score 823.0218709125478
2025-05-14 21:11:09,658 - INFO - Sample index 41 flagged with score 1090.1545761977063
2025-05-14 21:11:09,658 - INFO - Sample index 42 flagged with score 907.4458661549432
2025-05-14 21:11:09,658 - INFO - Sample index 43 flagged with score 985.9462459992433
2025-05-14 21:11:09,658 - INFO - Sample index 53 flagged with score 739.9304069559014
2025-05-14 21:11:09,658 - INFO - Sample index 54 flagged with score 1072.7711778380421
2025-05-14 21:11:09,658 - INFO - Sample index 77 flagged with score 736.0061187859354
2025-05-14 21:11:09,658 - INFO - Sample index 78 flagged with score 869.0851512004157
2025-05-14 21:11:09,658 - INFO - Sample index 79 flagged with score 1087.0975117256041
2025-05-14 21:11:09,658 - INFO - Sample index 124 flagged with score 838.0214794384939
2025-05-14 21:11:09,658 - INFO - Sample index 125 flagged with score 728.8058726437376
2025-05-14 21:11:09,658 - INFO - Sample index 126 flagged with score 1075.3208823416428
2025-05-14 21:11:09,658 - INFO - Sample index 127 flagged with score 895.963168885867
2025-05-14 21:11:09,658 - INFO - Sample index 147 flagged with score 1031.7238002488846
2025-05-14 21:11:09,658 - INFO - Sample index 148 flagged with score 1033.73158992302
2025-05-14 21:11:09,658 - INFO - Sample index 149 flagged with score 1377.2777497658196
2025-05-14 21:11:09,658 - INFO - Sample index 153 flagged with score 944.9047588758764
2025-05-14 21:11:09,658 - INFO - Model training completed
2025-05-14 21:11:09,658 - INFO - Initializing Isolation Forest and starting training
2025-05-14 21:11:09,719 - INFO - Isolation Forest predicted 17 anomalies out of 168
2025-05-14 21:11:09,719 - INFO - Initializing ECOD and starting training
2025-05-14 21:11:09,955 - INFO - ECOD predicted 17 anomalies out of 168
2025-05-14 21:11:09,955 - INFO - Initializing COPOD and starting training
2025-05-14 21:11:09,956 - INFO - COPOD predicted 17 anomalies out of 168
2025-05-14 21:11:09,956 - INFO - Starting anomaly predictions
2025-05-14 21:11:09,960 - INFO - Predictions array (0 normal, 1 anomaly): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2025-05-14 21:11:09,960 - INFO - Predicted anomalies for 9 out of 168 samples
2025-05-14 21:11:09,960 - INFO - Returning 9 anomaly indices
2025-05-14 21:11:09,960 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 21:11:10,981 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:11:10,982 - INFO - Received file: traffic_0.csv
2025-05-14 21:11:10,984 - INFO - Loaded DataFrame with 168 rows and 23 columns
2025-05-14 21:11:10,984 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 168 rows
2025-05-14 21:11:10,985 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_211110.csv
2025-05-14 21:11:10,985 - INFO - Initializing KNN model and starting training
2025-05-14 21:11:10,986 - INFO - Model decision threshold: 712.3621458715553
2025-05-14 21:11:10,986 - INFO - Decision scores summary – min: 2.9087066650390625e-05, max: 1377.2777497658196, mean: 180.14205502625506
2025-05-14 21:11:10,986 - INFO - Sample index 3 flagged with score 823.0218709125478
2025-05-14 21:11:10,986 - INFO - Sample index 41 flagged with score 1090.1545761977063
2025-05-14 21:11:10,986 - INFO - Sample index 42 flagged with score 907.4458661549432
2025-05-14 21:11:10,986 - INFO - Sample index 43 flagged with score 985.9462459992433
2025-05-14 21:11:10,986 - INFO - Sample index 53 flagged with score 739.9304069559014
2025-05-14 21:11:10,986 - INFO - Sample index 54 flagged with score 1072.7711778380421
2025-05-14 21:11:10,986 - INFO - Sample index 77 flagged with score 736.0061187859354
2025-05-14 21:11:10,986 - INFO - Sample index 78 flagged with score 869.0851512004157
2025-05-14 21:11:10,986 - INFO - Sample index 79 flagged with score 1087.0975117256041
2025-05-14 21:11:10,986 - INFO - Sample index 124 flagged with score 838.0214794384939
2025-05-14 21:11:10,986 - INFO - Sample index 125 flagged with score 728.8058726437376
2025-05-14 21:11:10,986 - INFO - Sample index 126 flagged with score 1075.3208823416428
2025-05-14 21:11:10,986 - INFO - Sample index 127 flagged with score 895.963168885867
2025-05-14 21:11:10,986 - INFO - Sample index 147 flagged with score 1031.7238002488846
2025-05-14 21:11:10,986 - INFO - Sample index 148 flagged with score 1033.73158992302
2025-05-14 21:11:10,986 - INFO - Sample index 149 flagged with score 1377.2777497658196
2025-05-14 21:11:10,986 - INFO - Sample index 153 flagged with score 944.9047588758764
2025-05-14 21:11:10,986 - INFO - Model training completed
2025-05-14 21:11:10,986 - INFO - Initializing Isolation Forest and starting training
2025-05-14 21:11:11,040 - INFO - Isolation Forest predicted 17 anomalies out of 168
2025-05-14 21:11:11,040 - INFO - Initializing ECOD and starting training
2025-05-14 21:11:11,041 - INFO - ECOD predicted 17 anomalies out of 168
2025-05-14 21:11:11,041 - INFO - Initializing COPOD and starting training
2025-05-14 21:11:11,042 - INFO - COPOD predicted 17 anomalies out of 168
2025-05-14 21:11:11,042 - INFO - Starting anomaly predictions
2025-05-14 21:11:11,045 - INFO - Predictions array (0 normal, 1 anomaly): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2025-05-14 21:11:11,045 - INFO - Predicted anomalies for 9 out of 168 samples
2025-05-14 21:11:11,045 - INFO - Returning 9 anomaly indices
2025-05-14 21:11:11,046 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 21:11:11,444 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:11:11,445 - INFO - Received file: traffic_0.csv
2025-05-14 21:11:11,447 - INFO - Loaded DataFrame with 168 rows and 23 columns
2025-05-14 21:11:11,447 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 168 rows
2025-05-14 21:11:11,448 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_211111.csv
2025-05-14 21:11:11,448 - INFO - Initializing KNN model and starting training
2025-05-14 21:11:11,449 - INFO - Model decision threshold: 712.3621458715553
2025-05-14 21:11:11,449 - INFO - Decision scores summary – min: 2.9087066650390625e-05, max: 1377.2777497658196, mean: 180.14205502625506
2025-05-14 21:11:11,449 - INFO - Sample index 3 flagged with score 823.0218709125478
2025-05-14 21:11:11,449 - INFO - Sample index 41 flagged with score 1090.1545761977063
2025-05-14 21:11:11,449 - INFO - Sample index 42 flagged with score 907.4458661549432
2025-05-14 21:11:11,449 - INFO - Sample index 43 flagged with score 985.9462459992433
2025-05-14 21:11:11,449 - INFO - Sample index 53 flagged with score 739.9304069559014
2025-05-14 21:11:11,449 - INFO - Sample index 54 flagged with score 1072.7711778380421
2025-05-14 21:11:11,449 - INFO - Sample index 77 flagged with score 736.0061187859354
2025-05-14 21:11:11,449 - INFO - Sample index 78 flagged with score 869.0851512004157
2025-05-14 21:11:11,449 - INFO - Sample index 79 flagged with score 1087.0975117256041
2025-05-14 21:11:11,449 - INFO - Sample index 124 flagged with score 838.0214794384939
2025-05-14 21:11:11,449 - INFO - Sample index 125 flagged with score 728.8058726437376
2025-05-14 21:11:11,449 - INFO - Sample index 126 flagged with score 1075.3208823416428
2025-05-14 21:11:11,449 - INFO - Sample index 127 flagged with score 895.963168885867
2025-05-14 21:11:11,449 - INFO - Sample index 147 flagged with score 1031.7238002488846
2025-05-14 21:11:11,449 - INFO - Sample index 148 flagged with score 1033.73158992302
2025-05-14 21:11:11,449 - INFO - Sample index 149 flagged with score 1377.2777497658196
2025-05-14 21:11:11,449 - INFO - Sample index 153 flagged with score 944.9047588758764
2025-05-14 21:11:11,449 - INFO - Model training completed
2025-05-14 21:11:11,449 - INFO - Initializing Isolation Forest and starting training
2025-05-14 21:11:11,505 - INFO - Isolation Forest predicted 17 anomalies out of 168
2025-05-14 21:11:11,505 - INFO - Initializing ECOD and starting training
2025-05-14 21:11:11,506 - INFO - ECOD predicted 17 anomalies out of 168
2025-05-14 21:11:11,506 - INFO - Initializing COPOD and starting training
2025-05-14 21:11:11,507 - INFO - COPOD predicted 17 anomalies out of 168
2025-05-14 21:11:11,507 - INFO - Starting anomaly predictions
2025-05-14 21:11:11,511 - INFO - Predictions array (0 normal, 1 anomaly): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2025-05-14 21:11:11,511 - INFO - Predicted anomalies for 9 out of 168 samples
2025-05-14 21:11:11,511 - INFO - Returning 9 anomaly indices
2025-05-14 21:11:11,511 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 21:11:11,827 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:11:11,828 - INFO - Received file: traffic_0.csv
2025-05-14 21:11:11,830 - INFO - Loaded DataFrame with 168 rows and 23 columns
2025-05-14 21:11:11,830 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 168 rows
2025-05-14 21:11:11,831 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_211111.csv
2025-05-14 21:11:11,831 - INFO - Initializing KNN model and starting training
2025-05-14 21:11:11,832 - INFO - Model decision threshold: 712.3621458715553
2025-05-14 21:11:11,832 - INFO - Decision scores summary – min: 2.9087066650390625e-05, max: 1377.2777497658196, mean: 180.14205502625506
2025-05-14 21:11:11,832 - INFO - Sample index 3 flagged with score 823.0218709125478
2025-05-14 21:11:11,832 - INFO - Sample index 41 flagged with score 1090.1545761977063
2025-05-14 21:11:11,832 - INFO - Sample index 42 flagged with score 907.4458661549432
2025-05-14 21:11:11,832 - INFO - Sample index 43 flagged with score 985.9462459992433
2025-05-14 21:11:11,832 - INFO - Sample index 53 flagged with score 739.9304069559014
2025-05-14 21:11:11,832 - INFO - Sample index 54 flagged with score 1072.7711778380421
2025-05-14 21:11:11,832 - INFO - Sample index 77 flagged with score 736.0061187859354
2025-05-14 21:11:11,832 - INFO - Sample index 78 flagged with score 869.0851512004157
2025-05-14 21:11:11,832 - INFO - Sample index 79 flagged with score 1087.0975117256041
2025-05-14 21:11:11,832 - INFO - Sample index 124 flagged with score 838.0214794384939
2025-05-14 21:11:11,832 - INFO - Sample index 125 flagged with score 728.8058726437376
2025-05-14 21:11:11,832 - INFO - Sample index 126 flagged with score 1075.3208823416428
2025-05-14 21:11:11,832 - INFO - Sample index 127 flagged with score 895.963168885867
2025-05-14 21:11:11,832 - INFO - Sample index 147 flagged with score 1031.7238002488846
2025-05-14 21:11:11,832 - INFO - Sample index 148 flagged with score 1033.73158992302
2025-05-14 21:11:11,832 - INFO - Sample index 149 flagged with score 1377.2777497658196
2025-05-14 21:11:11,832 - INFO - Sample index 153 flagged with score 944.9047588758764
2025-05-14 21:11:11,832 - INFO - Model training completed
2025-05-14 21:11:11,832 - INFO - Initializing Isolation Forest and starting training
2025-05-14 21:11:11,891 - INFO - Isolation Forest predicted 17 anomalies out of 168
2025-05-14 21:11:11,892 - INFO - Initializing ECOD and starting training
2025-05-14 21:11:11,893 - INFO - ECOD predicted 17 anomalies out of 168
2025-05-14 21:11:11,893 - INFO - Initializing COPOD and starting training
2025-05-14 21:11:11,894 - INFO - COPOD predicted 17 anomalies out of 168
2025-05-14 21:11:11,894 - INFO - Starting anomaly predictions
2025-05-14 21:11:11,897 - INFO - Predictions array (0 normal, 1 anomaly): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2025-05-14 21:11:11,898 - INFO - Predicted anomalies for 9 out of 168 samples
2025-05-14 21:11:11,898 - INFO - Returning 9 anomaly indices
2025-05-14 21:11:11,898 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 21:11:12,404 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:11:12,405 - INFO - Received file: traffic_0.csv
2025-05-14 21:11:12,406 - INFO - Loaded DataFrame with 168 rows and 23 columns
2025-05-14 21:11:12,407 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 168 rows
2025-05-14 21:11:12,407 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_211112.csv
2025-05-14 21:11:12,407 - INFO - Initializing KNN model and starting training
2025-05-14 21:11:12,408 - INFO - Model decision threshold: 712.3621458715553
2025-05-14 21:11:12,408 - INFO - Decision scores summary – min: 2.9087066650390625e-05, max: 1377.2777497658196, mean: 180.14205502625506
2025-05-14 21:11:12,408 - INFO - Sample index 3 flagged with score 823.0218709125478
2025-05-14 21:11:12,408 - INFO - Sample index 41 flagged with score 1090.1545761977063
2025-05-14 21:11:12,408 - INFO - Sample index 42 flagged with score 907.4458661549432
2025-05-14 21:11:12,408 - INFO - Sample index 43 flagged with score 985.9462459992433
2025-05-14 21:11:12,408 - INFO - Sample index 53 flagged with score 739.9304069559014
2025-05-14 21:11:12,408 - INFO - Sample index 54 flagged with score 1072.7711778380421
2025-05-14 21:11:12,408 - INFO - Sample index 77 flagged with score 736.0061187859354
2025-05-14 21:11:12,409 - INFO - Sample index 78 flagged with score 869.0851512004157
2025-05-14 21:11:12,409 - INFO - Sample index 79 flagged with score 1087.0975117256041
2025-05-14 21:11:12,409 - INFO - Sample index 124 flagged with score 838.0214794384939
2025-05-14 21:11:12,409 - INFO - Sample index 125 flagged with score 728.8058726437376
2025-05-14 21:11:12,409 - INFO - Sample index 126 flagged with score 1075.3208823416428
2025-05-14 21:11:12,409 - INFO - Sample index 127 flagged with score 895.963168885867
2025-05-14 21:11:12,409 - INFO - Sample index 147 flagged with score 1031.7238002488846
2025-05-14 21:11:12,409 - INFO - Sample index 148 flagged with score 1033.73158992302
2025-05-14 21:11:12,409 - INFO - Sample index 149 flagged with score 1377.2777497658196
2025-05-14 21:11:12,409 - INFO - Sample index 153 flagged with score 944.9047588758764
2025-05-14 21:11:12,409 - INFO - Model training completed
2025-05-14 21:11:12,409 - INFO - Initializing Isolation Forest and starting training
2025-05-14 21:11:12,464 - INFO - Isolation Forest predicted 17 anomalies out of 168
2025-05-14 21:11:12,464 - INFO - Initializing ECOD and starting training
2025-05-14 21:11:12,466 - INFO - ECOD predicted 17 anomalies out of 168
2025-05-14 21:11:12,466 - INFO - Initializing COPOD and starting training
2025-05-14 21:11:12,467 - INFO - COPOD predicted 17 anomalies out of 168
2025-05-14 21:11:12,467 - INFO - Starting anomaly predictions
2025-05-14 21:11:12,470 - INFO - Predictions array (0 normal, 1 anomaly): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2025-05-14 21:11:12,470 - INFO - Predicted anomalies for 9 out of 168 samples
2025-05-14 21:11:12,470 - INFO - Returning 9 anomaly indices
2025-05-14 21:11:12,471 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 21:14:51,259 - INFO - 日志系统已初始化
2025-05-14 21:14:57,042 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:14:57,043 - INFO - Received file: traffic_0.csv
2025-05-14 21:14:57,046 - INFO - Loaded DataFrame with 168 rows and 23 columns
2025-05-14 21:14:57,047 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 168 rows
2025-05-14 21:14:57,048 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_211457.csv
2025-05-14 21:14:57,048 - INFO - Initializing KNN model and starting training
2025-05-14 21:14:57,050 - INFO - Model decision threshold: 712.3621458715553
2025-05-14 21:14:57,050 - INFO - Decision scores summary – min: 2.9087066650390625e-05, max: 1377.2777497658196, mean: 180.14205502625506
2025-05-14 21:14:57,050 - INFO - Sample index 3 flagged with score 823.0218709125478
2025-05-14 21:14:57,050 - INFO - Sample index 41 flagged with score 1090.1545761977063
2025-05-14 21:14:57,050 - INFO - Sample index 42 flagged with score 907.4458661549432
2025-05-14 21:14:57,050 - INFO - Sample index 43 flagged with score 985.9462459992433
2025-05-14 21:14:57,050 - INFO - Sample index 53 flagged with score 739.9304069559014
2025-05-14 21:14:57,050 - INFO - Sample index 54 flagged with score 1072.7711778380421
2025-05-14 21:14:57,050 - INFO - Sample index 77 flagged with score 736.0061187859354
2025-05-14 21:14:57,050 - INFO - Sample index 78 flagged with score 869.0851512004157
2025-05-14 21:14:57,050 - INFO - Sample index 79 flagged with score 1087.0975117256041
2025-05-14 21:14:57,050 - INFO - Sample index 124 flagged with score 838.0214794384939
2025-05-14 21:14:57,050 - INFO - Sample index 125 flagged with score 728.8058726437376
2025-05-14 21:14:57,050 - INFO - Sample index 126 flagged with score 1075.3208823416428
2025-05-14 21:14:57,050 - INFO - Sample index 127 flagged with score 895.963168885867
2025-05-14 21:14:57,050 - INFO - Sample index 147 flagged with score 1031.7238002488846
2025-05-14 21:14:57,050 - INFO - Sample index 148 flagged with score 1033.73158992302
2025-05-14 21:14:57,050 - INFO - Sample index 149 flagged with score 1377.2777497658196
2025-05-14 21:14:57,050 - INFO - Sample index 153 flagged with score 944.9047588758764
2025-05-14 21:14:57,050 - INFO - Model training completed
2025-05-14 21:14:57,050 - INFO - Initializing Isolation Forest and starting training
2025-05-14 21:14:57,111 - INFO - Isolation Forest predicted 17 anomalies out of 168
2025-05-14 21:14:57,111 - INFO - Initializing ECOD and starting training
2025-05-14 21:14:57,289 - INFO - ECOD predicted 17 anomalies out of 168
2025-05-14 21:14:57,289 - INFO - Initializing COPOD and starting training
2025-05-14 21:14:57,290 - INFO - COPOD predicted 17 anomalies out of 168
2025-05-14 21:14:57,291 - INFO - Starting anomaly predictions
2025-05-14 21:14:57,294 - INFO - Predictions array (0 normal, 1 anomaly): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2025-05-14 21:14:57,294 - INFO - Predicted anomalies for 9 out of 168 samples
2025-05-14 21:14:57,294 - INFO - Returning 9 anomaly indices
2025-05-14 21:14:57,295 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 21:22:33,625 - INFO - 日志系统已初始化
2025-05-14 21:22:40,173 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:22:40,174 - INFO - Received file: traffic_0.csv
2025-05-14 21:22:40,177 - INFO - Loaded DataFrame with 168 rows and 23 columns
2025-05-14 21:22:40,177 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 168 rows
2025-05-14 21:22:40,190 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_212240.csv
2025-05-14 21:22:40,190 - INFO - Initializing KNN model and starting training
2025-05-14 21:22:40,221 - INFO - Model decision threshold: 15022.978835440037
2025-05-14 21:22:40,221 - INFO - Decision scores summary – min: 0.0, max: 1583526330.2762392, mean: 21984367.884695485
2025-05-14 21:22:40,221 - INFO - Sample index 14 flagged with score 1583526330.2762392
2025-05-14 21:22:40,221 - INFO - Sample index 15 flagged with score 1583526330.2762377
2025-05-14 21:22:40,221 - INFO - Sample index 101 flagged with score 35222233.4197351
2025-05-14 21:22:40,221 - INFO - Sample index 102 flagged with score 35222233.4197351
2025-05-14 21:22:40,221 - INFO - Sample index 103 flagged with score 35222233.419589736
2025-05-14 21:22:40,221 - INFO - Sample index 104 flagged with score 35222233.41996768
2025-05-14 21:22:40,221 - INFO - Sample index 105 flagged with score 35222233.41964788
2025-05-14 21:22:40,221 - INFO - Sample index 106 flagged with score 35222233.41964788
2025-05-14 21:22:40,221 - INFO - Sample index 121 flagged with score 39349630.446966484
2025-05-14 21:22:40,221 - INFO - Sample index 122 flagged with score 39349630.44699251
2025-05-14 21:22:40,221 - INFO - Sample index 156 flagged with score 39349630.44699251
2025-05-14 21:22:40,221 - INFO - Sample index 157 flagged with score 39349630.44699251
2025-05-14 21:22:40,221 - INFO - Sample index 158 flagged with score 39349630.446966484
2025-05-14 21:22:40,221 - INFO - Sample index 159 flagged with score 39349630.44694047
2025-05-14 21:22:40,221 - INFO - Sample index 160 flagged with score 39349630.44699251
2025-05-14 21:22:40,221 - INFO - Sample index 161 flagged with score 39349630.446966484
2025-05-14 21:22:40,221 - INFO - Model training completed
2025-05-14 21:22:40,221 - INFO - Initializing Isolation Forest and starting training
2025-05-14 21:22:40,283 - INFO - Isolation Forest predicted 17 anomalies out of 168
2025-05-14 21:22:40,283 - INFO - Initializing ECOD and starting training
2025-05-14 21:22:40,478 - ERROR - Error in detect_anomalies: Failed in nopython mode pipeline (step: nopython frontend)
non-precise type array(pyobject, 2d, C)
During: typing of argument at /Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pyod/utils/stat_models.py (230)

File ".venv/lib/python3.13/site-packages/pyod/utils/stat_models.py", line 230:
def column_ecdf(matrix: np.ndarray) -> np.ndarray:
    <source elided>

@njit
^

During: Pass nopython_type_inference
Traceback (most recent call last):
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/ml_pyod.py", line 157, in detect_anomalies
    ecod_preds = ecod_clf.predict(df_selected)
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pyod/models/base.py", line 162, in predict
    pred_score = self.decision_function(X)
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pyod/models/ecod.py", line 133, in decision_function
    self.U_l = -1 * np.log(column_ecdf(X))
                           ~~~~~~~~~~~^^^
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pyod/utils/stat_models.py", line 221, in column_ecdf
    ecdf_terminate_equals_inplace(matrix, probabilities)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/numba/core/dispatcher.py", line 424, in _compile_for_args
    error_rewrite(e, 'typing')
    ~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/numba/core/dispatcher.py", line 365, in error_rewrite
    raise e.with_traceback(None)
numba.core.errors.TypingError: Failed in nopython mode pipeline (step: nopython frontend)
non-precise type array(pyobject, 2d, C)
During: typing of argument at /Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pyod/utils/stat_models.py (230)

File ".venv/lib/python3.13/site-packages/pyod/utils/stat_models.py", line 230:
def column_ecdf(matrix: np.ndarray) -> np.ndarray:
    <source elided>

@njit
^

During: Pass nopython_type_inference
2025-05-14 21:22:40,480 - INFO - Completed request: POST /ml/detect -> 500
2025-05-14 21:31:13,605 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:31:13,606 - INFO - Received file: traffic_0.csv
2025-05-14 21:31:13,610 - INFO - Loaded DataFrame with 168 rows and 23 columns
2025-05-14 21:31:13,611 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 168 rows
2025-05-14 21:31:13,629 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_213113.csv
2025-05-14 21:31:13,629 - INFO - Initializing KNN model and starting training
2025-05-14 21:31:13,632 - INFO - Model decision threshold: 15022.978835440037
2025-05-14 21:31:13,632 - INFO - Decision scores summary – min: 0.0, max: 1583526330.2762392, mean: 21984367.884695485
2025-05-14 21:31:13,633 - INFO - Sample index 14 flagged with score 1583526330.2762392
2025-05-14 21:31:13,633 - INFO - Sample index 15 flagged with score 1583526330.2762377
2025-05-14 21:31:13,633 - INFO - Sample index 101 flagged with score 35222233.4197351
2025-05-14 21:31:13,633 - INFO - Sample index 102 flagged with score 35222233.4197351
2025-05-14 21:31:13,633 - INFO - Sample index 103 flagged with score 35222233.419589736
2025-05-14 21:31:13,633 - INFO - Sample index 104 flagged with score 35222233.41996768
2025-05-14 21:31:13,633 - INFO - Sample index 105 flagged with score 35222233.41964788
2025-05-14 21:31:13,633 - INFO - Sample index 106 flagged with score 35222233.41964788
2025-05-14 21:31:13,633 - INFO - Sample index 121 flagged with score 39349630.446966484
2025-05-14 21:31:13,633 - INFO - Sample index 122 flagged with score 39349630.44699251
2025-05-14 21:31:13,633 - INFO - Sample index 156 flagged with score 39349630.44699251
2025-05-14 21:31:13,633 - INFO - Sample index 157 flagged with score 39349630.44699251
2025-05-14 21:31:13,633 - INFO - Sample index 158 flagged with score 39349630.446966484
2025-05-14 21:31:13,633 - INFO - Sample index 159 flagged with score 39349630.44694047
2025-05-14 21:31:13,633 - INFO - Sample index 160 flagged with score 39349630.44699251
2025-05-14 21:31:13,633 - INFO - Sample index 161 flagged with score 39349630.446966484
2025-05-14 21:31:13,633 - INFO - Model training completed
2025-05-14 21:31:13,633 - INFO - Initializing Isolation Forest and starting training
2025-05-14 21:31:13,698 - INFO - Isolation Forest predicted 17 anomalies out of 168
2025-05-14 21:31:13,699 - INFO - Initializing ECOD and starting training
2025-05-14 21:31:13,701 - ERROR - Error in detect_anomalies: Failed in nopython mode pipeline (step: nopython frontend)
non-precise type array(pyobject, 2d, C)
During: typing of argument at /Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pyod/utils/stat_models.py (230)

File ".venv/lib/python3.13/site-packages/pyod/utils/stat_models.py", line 230:
def column_ecdf(matrix: np.ndarray) -> np.ndarray:
    <source elided>

@njit
^

During: Pass nopython_type_inference
Traceback (most recent call last):
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/ml_pyod.py", line 157, in detect_anomalies
    logger.info("Initializing ECOD and starting training")
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pyod/models/base.py", line 162, in predict
    pred_score = self.decision_function(X)
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pyod/models/ecod.py", line 133, in decision_function
    self.U_l = -1 * np.log(column_ecdf(X))
                           ~~~~~~~~~~~^^^
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pyod/utils/stat_models.py", line 221, in column_ecdf
    ecdf_terminate_equals_inplace(matrix, probabilities)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/numba/core/dispatcher.py", line 424, in _compile_for_args
    error_rewrite(e, 'typing')
    ~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/numba/core/dispatcher.py", line 365, in error_rewrite
    raise e.with_traceback(None)
numba.core.errors.TypingError: Failed in nopython mode pipeline (step: nopython frontend)
non-precise type array(pyobject, 2d, C)
During: typing of argument at /Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pyod/utils/stat_models.py (230)

File ".venv/lib/python3.13/site-packages/pyod/utils/stat_models.py", line 230:
def column_ecdf(matrix: np.ndarray) -> np.ndarray:
    <source elided>

@njit
^

During: Pass nopython_type_inference
2025-05-14 21:31:13,702 - INFO - Completed request: POST /ml/detect -> 500
2025-05-14 21:32:17,465 - INFO - 日志系统已初始化
2025-05-14 21:32:29,975 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:32:29,976 - INFO - Received file: traffic_0.csv
2025-05-14 21:32:29,980 - INFO - Loaded DataFrame with 168 rows and 23 columns
2025-05-14 21:32:29,981 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 168 rows
2025-05-14 21:32:29,989 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_213229.csv
2025-05-14 21:32:29,989 - INFO - Initializing KNN model and starting training
2025-05-14 21:32:30,012 - INFO - Model decision threshold: 15022.978835440037
2025-05-14 21:32:30,012 - INFO - Decision scores summary – min: 0.0, max: 1583526330.2762392, mean: 21984367.884695485
2025-05-14 21:32:30,012 - INFO - Sample index 14 flagged with score 1583526330.2762392
2025-05-14 21:32:30,012 - INFO - Sample index 15 flagged with score 1583526330.2762377
2025-05-14 21:32:30,012 - INFO - Sample index 101 flagged with score 35222233.4197351
2025-05-14 21:32:30,012 - INFO - Sample index 102 flagged with score 35222233.4197351
2025-05-14 21:32:30,012 - INFO - Sample index 103 flagged with score 35222233.419589736
2025-05-14 21:32:30,012 - INFO - Sample index 104 flagged with score 35222233.41996768
2025-05-14 21:32:30,012 - INFO - Sample index 105 flagged with score 35222233.41964788
2025-05-14 21:32:30,012 - INFO - Sample index 106 flagged with score 35222233.41964788
2025-05-14 21:32:30,012 - INFO - Sample index 121 flagged with score 39349630.446966484
2025-05-14 21:32:30,012 - INFO - Sample index 122 flagged with score 39349630.44699251
2025-05-14 21:32:30,012 - INFO - Sample index 156 flagged with score 39349630.44699251
2025-05-14 21:32:30,012 - INFO - Sample index 157 flagged with score 39349630.44699251
2025-05-14 21:32:30,012 - INFO - Sample index 158 flagged with score 39349630.446966484
2025-05-14 21:32:30,012 - INFO - Sample index 159 flagged with score 39349630.44694047
2025-05-14 21:32:30,012 - INFO - Sample index 160 flagged with score 39349630.44699251
2025-05-14 21:32:30,012 - INFO - Sample index 161 flagged with score 39349630.446966484
2025-05-14 21:32:30,012 - INFO - Model training completed
2025-05-14 21:32:30,012 - INFO - Initializing Isolation Forest and starting training
2025-05-14 21:32:30,073 - INFO - Isolation Forest predicted 17 anomalies out of 168
2025-05-14 21:32:30,073 - INFO - Initializing ECOD and starting training
2025-05-14 21:32:30,264 - ERROR - Error in detect_anomalies: Failed in nopython mode pipeline (step: nopython frontend)
non-precise type array(pyobject, 2d, C)
During: typing of argument at /Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pyod/utils/stat_models.py (230)

File ".venv/lib/python3.13/site-packages/pyod/utils/stat_models.py", line 230:
def column_ecdf(matrix: np.ndarray) -> np.ndarray:
    <source elided>

@njit
^

During: Pass nopython_type_inference
Traceback (most recent call last):
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/ml_pyod.py", line 160, in detect_anomalies
    ecod_preds = ecod_clf.predict(X)
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pyod/models/base.py", line 162, in predict
    pred_score = self.decision_function(X)
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pyod/models/ecod.py", line 133, in decision_function
    self.U_l = -1 * np.log(column_ecdf(X))
                           ~~~~~~~~~~~^^^
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pyod/utils/stat_models.py", line 221, in column_ecdf
    ecdf_terminate_equals_inplace(matrix, probabilities)
    ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/numba/core/dispatcher.py", line 424, in _compile_for_args
    error_rewrite(e, 'typing')
    ~~~~~~~~~~~~~^^^^^^^^^^^^^
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/numba/core/dispatcher.py", line 365, in error_rewrite
    raise e.with_traceback(None)
numba.core.errors.TypingError: Failed in nopython mode pipeline (step: nopython frontend)
non-precise type array(pyobject, 2d, C)
During: typing of argument at /Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pyod/utils/stat_models.py (230)

File ".venv/lib/python3.13/site-packages/pyod/utils/stat_models.py", line 230:
def column_ecdf(matrix: np.ndarray) -> np.ndarray:
    <source elided>

@njit
^

During: Pass nopython_type_inference
2025-05-14 21:32:30,266 - INFO - Completed request: POST /ml/detect -> 500
2025-05-14 21:35:39,368 - INFO - 日志系统已初始化
2025-05-14 21:36:37,373 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:36:37,376 - INFO - Received file: traffic_0.csv
2025-05-14 21:36:37,381 - INFO - Loaded DataFrame with 168 rows and 23 columns
2025-05-14 21:36:37,383 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 168 rows
2025-05-14 21:36:37,398 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_213637.csv
2025-05-14 21:36:37,401 - INFO - Features retained after VarianceThreshold (16): ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count', 'minute', 'second', 'src_ip_int', 'dst_ip_int', 'src_port', 'dst_port', 'tcp_flag_S', 'tcp_flag_A', 'tcp_flag_F', 'tcp_flag_R', 'tcp_flag_P', 'payload_len']
2025-05-14 21:36:37,401 - INFO - Initializing KNN model and starting training
2025-05-14 21:36:37,431 - INFO - Model decision threshold: 15022.978835440037
2025-05-14 21:36:37,431 - INFO - Decision scores summary – min: 0.0, max: 1583526330.2762392, mean: 21984368.121939544
2025-05-14 21:36:37,431 - INFO - Sample index 14 flagged with score 1583526330.2762392
2025-05-14 21:36:37,431 - INFO - Sample index 15 flagged with score 1583526330.2762384
2025-05-14 21:36:37,431 - INFO - Sample index 101 flagged with score 35222233.4197351
2025-05-14 21:36:37,431 - INFO - Sample index 102 flagged with score 35222233.4197351
2025-05-14 21:36:37,431 - INFO - Sample index 103 flagged with score 35222233.41961881
2025-05-14 21:36:37,431 - INFO - Sample index 104 flagged with score 35222233.41996768
2025-05-14 21:36:37,431 - INFO - Sample index 105 flagged with score 35222233.41961881
2025-05-14 21:36:37,431 - INFO - Sample index 106 flagged with score 35222233.419589736
2025-05-14 21:36:37,431 - INFO - Sample index 121 flagged with score 39349630.44694047
2025-05-14 21:36:37,431 - INFO - Sample index 122 flagged with score 39349630.44699251
2025-05-14 21:36:37,431 - INFO - Sample index 156 flagged with score 39349630.446966484
2025-05-14 21:36:37,431 - INFO - Sample index 157 flagged with score 39349630.44699251
2025-05-14 21:36:37,431 - INFO - Sample index 158 flagged with score 39349630.446966484
2025-05-14 21:36:37,431 - INFO - Sample index 159 flagged with score 39349630.44694047
2025-05-14 21:36:37,431 - INFO - Sample index 160 flagged with score 39349630.44699251
2025-05-14 21:36:37,432 - INFO - Sample index 161 flagged with score 39349630.446966484
2025-05-14 21:36:37,432 - INFO - Model training completed
2025-05-14 21:36:37,432 - INFO - Initializing Isolation Forest and starting training
2025-05-14 21:36:37,492 - INFO - Isolation Forest predicted 17 anomalies out of 168
2025-05-14 21:36:37,492 - INFO - Initializing ECOD and starting training
2025-05-14 21:36:37,676 - INFO - ECOD predicted 17 anomalies out of 168
2025-05-14 21:36:37,676 - INFO - Initializing COPOD and starting training
2025-05-14 21:36:37,677 - INFO - COPOD predicted 17 anomalies out of 168
2025-05-14 21:36:37,677 - INFO - Starting anomaly predictions
2025-05-14 21:36:37,681 - INFO - Predictions array (0 normal, 1 anomaly): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0]
2025-05-14 21:36:37,681 - INFO - Predicted anomalies for 16 out of 168 samples
2025-05-14 21:36:37,681 - INFO - Returning 16 anomaly indices
2025-05-14 21:36:37,681 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 21:38:13,512 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:38:13,525 - INFO - Received file: traffic_0.csv
2025-05-14 21:38:13,577 - INFO - Loaded DataFrame with 7642 rows and 21 columns
2025-05-14 21:38:13,577 - ERROR - Error in detect_anomalies: "['inter_arrival'] not in index"
Traceback (most recent call last):
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/ml_pyod.py", line 66, in detect_anomalies
    df_selected = df[features].dropna()
                  ~~^^^^^^^^^^
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['inter_arrival'] not in index"
2025-05-14 21:38:13,584 - INFO - Completed request: POST /ml/detect -> 500
2025-05-14 21:38:15,304 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:38:15,317 - INFO - Received file: traffic_0.csv
2025-05-14 21:38:15,365 - INFO - Loaded DataFrame with 7642 rows and 21 columns
2025-05-14 21:38:15,365 - ERROR - Error in detect_anomalies: "['inter_arrival'] not in index"
Traceback (most recent call last):
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/ml_pyod.py", line 66, in detect_anomalies
    df_selected = df[features].dropna()
                  ~~^^^^^^^^^^
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pandas/core/frame.py", line 4108, in __getitem__
    indexer = self.columns._get_indexer_strict(key, "columns")[1]
              ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 6200, in _get_indexer_strict
    self._raise_if_missing(keyarr, indexer, axis_name)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/recallingrain/Project-Code/PycharmProjects/System/.venv/lib/python3.13/site-packages/pandas/core/indexes/base.py", line 6252, in _raise_if_missing
    raise KeyError(f"{not_found} not in index")
KeyError: "['inter_arrival'] not in index"
2025-05-14 21:38:15,367 - INFO - Completed request: POST /ml/detect -> 500
2025-05-14 21:38:23,947 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:38:23,948 - INFO - Received file: traffic_0.csv
2025-05-14 21:38:23,950 - INFO - Loaded DataFrame with 168 rows and 23 columns
2025-05-14 21:38:23,950 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 168 rows
2025-05-14 21:38:23,956 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_213823.csv
2025-05-14 21:38:23,957 - INFO - Features retained after VarianceThreshold (16): ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count', 'minute', 'second', 'src_ip_int', 'dst_ip_int', 'src_port', 'dst_port', 'tcp_flag_S', 'tcp_flag_A', 'tcp_flag_F', 'tcp_flag_R', 'tcp_flag_P', 'payload_len']
2025-05-14 21:38:23,957 - INFO - Initializing KNN model and starting training
2025-05-14 21:38:23,958 - INFO - Model decision threshold: 15022.978835440037
2025-05-14 21:38:23,958 - INFO - Decision scores summary – min: 0.0, max: 1583526330.2762392, mean: 21984368.121939544
2025-05-14 21:38:23,958 - INFO - Sample index 14 flagged with score 1583526330.2762392
2025-05-14 21:38:23,958 - INFO - Sample index 15 flagged with score 1583526330.2762384
2025-05-14 21:38:23,958 - INFO - Sample index 101 flagged with score 35222233.4197351
2025-05-14 21:38:23,958 - INFO - Sample index 102 flagged with score 35222233.4197351
2025-05-14 21:38:23,958 - INFO - Sample index 103 flagged with score 35222233.41961881
2025-05-14 21:38:23,958 - INFO - Sample index 104 flagged with score 35222233.41996768
2025-05-14 21:38:23,958 - INFO - Sample index 105 flagged with score 35222233.41961881
2025-05-14 21:38:23,958 - INFO - Sample index 106 flagged with score 35222233.419589736
2025-05-14 21:38:23,958 - INFO - Sample index 121 flagged with score 39349630.44694047
2025-05-14 21:38:23,958 - INFO - Sample index 122 flagged with score 39349630.44699251
2025-05-14 21:38:23,958 - INFO - Sample index 156 flagged with score 39349630.446966484
2025-05-14 21:38:23,958 - INFO - Sample index 157 flagged with score 39349630.44699251
2025-05-14 21:38:23,958 - INFO - Sample index 158 flagged with score 39349630.446966484
2025-05-14 21:38:23,958 - INFO - Sample index 159 flagged with score 39349630.44694047
2025-05-14 21:38:23,958 - INFO - Sample index 160 flagged with score 39349630.44699251
2025-05-14 21:38:23,958 - INFO - Sample index 161 flagged with score 39349630.446966484
2025-05-14 21:38:23,958 - INFO - Model training completed
2025-05-14 21:38:23,958 - INFO - Initializing Isolation Forest and starting training
2025-05-14 21:38:24,018 - INFO - Isolation Forest predicted 17 anomalies out of 168
2025-05-14 21:38:24,018 - INFO - Initializing ECOD and starting training
2025-05-14 21:38:24,019 - INFO - ECOD predicted 17 anomalies out of 168
2025-05-14 21:38:24,019 - INFO - Initializing COPOD and starting training
2025-05-14 21:38:24,021 - INFO - COPOD predicted 17 anomalies out of 168
2025-05-14 21:38:24,021 - INFO - Starting anomaly predictions
2025-05-14 21:38:24,024 - INFO - Predictions array (0 normal, 1 anomaly): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0]
2025-05-14 21:38:24,024 - INFO - Predicted anomalies for 16 out of 168 samples
2025-05-14 21:38:24,024 - INFO - Returning 16 anomaly indices
2025-05-14 21:38:24,025 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 21:38:28,742 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:38:28,744 - INFO - Received file: traffic_0.csv
2025-05-14 21:38:28,752 - INFO - Loaded DataFrame with 1065 rows and 25 columns
2025-05-14 21:38:28,753 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 1065 rows
2025-05-14 21:38:28,771 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_213828.csv
2025-05-14 21:38:28,772 - INFO - Features retained after VarianceThreshold (16): ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count', 'minute', 'second', 'src_ip_int', 'dst_ip_int', 'src_port', 'dst_port', 'tcp_flag_S', 'tcp_flag_A', 'tcp_flag_F', 'tcp_flag_R', 'tcp_flag_P', 'payload_len']
2025-05-14 21:38:28,772 - INFO - Initializing KNN model and starting training
2025-05-14 21:38:28,777 - INFO - Model decision threshold: 570.2919170197597
2025-05-14 21:38:28,777 - INFO - Decision scores summary – min: 0.0, max: 2901421966.0668354, mean: 10897611.986538371
2025-05-14 21:38:28,777 - INFO - Sample index 20 flagged with score 658.920329023168
2025-05-14 21:38:28,777 - INFO - Sample index 21 flagged with score 658.920329023168
2025-05-14 21:38:28,777 - INFO - Sample index 29 flagged with score 1393.3786276529434
2025-05-14 21:38:28,777 - INFO - Sample index 31 flagged with score 1244.3022140943092
2025-05-14 21:38:28,777 - INFO - Sample index 32 flagged with score 1297.4806356936508
2025-05-14 21:38:28,777 - INFO - Sample index 34 flagged with score 1393.3786276529434
2025-05-14 21:38:28,777 - INFO - Sample index 36 flagged with score 1242.6552216926464
2025-05-14 21:38:28,777 - INFO - Sample index 37 flagged with score 1295.9012308042616
2025-05-14 21:38:28,777 - INFO - Sample index 41 flagged with score 658.920329023168
2025-05-14 21:38:28,777 - INFO - Sample index 55 flagged with score 1393.3786276529434
2025-05-14 21:38:28,777 - INFO - Sample index 59 flagged with score 1297.4806356936508
2025-05-14 21:38:28,777 - INFO - Sample index 60 flagged with score 1242.6552216926464
2025-05-14 21:38:28,777 - INFO - Sample index 95 flagged with score 593.511583711725
2025-05-14 21:38:28,777 - INFO - Sample index 173 flagged with score 1119.5427638102976
2025-05-14 21:38:28,777 - INFO - Sample index 176 flagged with score 1112.201420606897
2025-05-14 21:38:28,777 - INFO - Sample index 203 flagged with score 1104.8112961044524
2025-05-14 21:38:28,777 - INFO - Sample index 263 flagged with score 738.084006058931
2025-05-14 21:38:28,777 - INFO - Sample index 265 flagged with score 2121.6748101440994
2025-05-14 21:38:28,777 - INFO - Sample index 266 flagged with score 1927.4522043360764
2025-05-14 21:38:28,777 - INFO - Sample index 270 flagged with score 1918.3993327771984
2025-05-14 21:38:28,777 - INFO - Sample index 272 flagged with score 1174.8838240438924
2025-05-14 21:38:28,777 - INFO - Sample index 281 flagged with score 1745.1005701678055
2025-05-14 21:38:28,777 - INFO - Sample index 282 flagged with score 1612.7492055493315
2025-05-14 21:38:28,777 - INFO - Sample index 283 flagged with score 1678.704262221312
2025-05-14 21:38:28,777 - INFO - Sample index 284 flagged with score 1546.6298846201053
2025-05-14 21:38:28,777 - INFO - Sample index 289 flagged with score 1142.180371044784
2025-05-14 21:38:28,777 - INFO - Sample index 291 flagged with score 671.237662828897
2025-05-14 21:38:28,777 - INFO - Sample index 292 flagged with score 1216.8418138772188
2025-05-14 21:38:28,777 - INFO - Sample index 293 flagged with score 729.7122720634483
2025-05-14 21:38:28,777 - INFO - Sample index 294 flagged with score 1115.8781295464125
2025-05-14 21:38:28,777 - INFO - Sample index 483 flagged with score 6498.915601852358
2025-05-14 21:38:28,777 - INFO - Sample index 484 flagged with score 3791.020970662125
2025-05-14 21:38:28,777 - INFO - Sample index 485 flagged with score 5145.038775364089
2025-05-14 21:38:28,777 - INFO - Sample index 486 flagged with score 3791.156024222691
2025-05-14 21:38:28,777 - INFO - Sample index 487 flagged with score 3810.419399488723
2025-05-14 21:38:28,777 - INFO - Sample index 488 flagged with score 3791.020970662125
2025-05-14 21:38:28,777 - INFO - Sample index 489 flagged with score 3791.156024222691
2025-05-14 21:38:28,777 - INFO - Sample index 490 flagged with score 4061.9837518138843
2025-05-14 21:38:28,777 - INFO - Sample index 491 flagged with score 4062.1097966450884
2025-05-14 21:38:28,777 - INFO - Sample index 492 flagged with score 4062.1097966450884
2025-05-14 21:38:28,777 - INFO - Sample index 509 flagged with score 4061.9837518138843
2025-05-14 21:38:28,777 - INFO - Sample index 511 flagged with score 4062.1097966450884
2025-05-14 21:38:28,777 - INFO - Sample index 512 flagged with score 4061.9837518138843
2025-05-14 21:38:28,777 - INFO - Sample index 513 flagged with score 4062.1097966450884
2025-05-14 21:38:28,777 - INFO - Sample index 515 flagged with score 4061.8577030713423
2025-05-14 21:38:28,777 - INFO - Sample index 517 flagged with score 4061.9837518138843
2025-05-14 21:38:28,777 - INFO - Sample index 518 flagged with score 4061.8577030713423
2025-05-14 21:38:28,777 - INFO - Sample index 519 flagged with score 4061.8577030713423
2025-05-14 21:38:28,777 - INFO - Sample index 520 flagged with score 4061.7316504170976
2025-05-14 21:38:28,777 - INFO - Sample index 521 flagged with score 4061.8577030713423
2025-05-14 21:38:28,777 - INFO - Sample index 522 flagged with score 4061.9837518138843
2025-05-14 21:38:28,777 - INFO - Sample index 523 flagged with score 4061.7316504170976
2025-05-14 21:38:28,777 - INFO - Sample index 524 flagged with score 4061.7316504170976
2025-05-14 21:38:28,777 - INFO - Sample index 525 flagged with score 4061.7316504170976
2025-05-14 21:38:28,777 - INFO - Sample index 526 flagged with score 4061.9837518138843
2025-05-14 21:38:28,778 - INFO - Sample index 527 flagged with score 4061.9837518138843
2025-05-14 21:38:28,778 - INFO - Sample index 528 flagged with score 4062.1097966450884
2025-05-14 21:38:28,778 - INFO - Sample index 529 flagged with score 4061.7316504170976
2025-05-14 21:38:28,778 - INFO - Sample index 530 flagged with score 4061.9837518138843
2025-05-14 21:38:28,778 - INFO - Sample index 531 flagged with score 4061.9837518138843
2025-05-14 21:38:28,778 - INFO - Sample index 542 flagged with score 665.1075101064489
2025-05-14 21:38:28,778 - INFO - Sample index 551 flagged with score 1390.4359028736276
2025-05-14 21:38:28,778 - INFO - Sample index 553 flagged with score 1299.058120331804
2025-05-14 21:38:28,778 - INFO - Sample index 555 flagged with score 1241.0060434985803
2025-05-14 21:38:28,778 - INFO - Sample index 557 flagged with score 4061.9837518138843
2025-05-14 21:38:28,778 - INFO - Sample index 558 flagged with score 4061.8577030713423
2025-05-14 21:38:28,778 - INFO - Sample index 559 flagged with score 667.4129156676547
2025-05-14 21:38:28,778 - INFO - Sample index 560 flagged with score 4061.8577030713423
2025-05-14 21:38:28,778 - INFO - Sample index 561 flagged with score 3547.817357193011
2025-05-14 21:38:28,778 - INFO - Sample index 562 flagged with score 2042.7432535685928
2025-05-14 21:38:28,778 - INFO - Sample index 563 flagged with score 2815.4544926174885
2025-05-14 21:38:28,778 - INFO - Sample index 564 flagged with score 770.6620530427069
2025-05-14 21:38:28,778 - INFO - Sample index 565 flagged with score 970.6080568385985
2025-05-14 21:38:28,778 - INFO - Sample index 566 flagged with score 736.0
2025-05-14 21:38:28,778 - INFO - Sample index 567 flagged with score 676.5559843797112
2025-05-14 21:38:28,778 - INFO - Sample index 570 flagged with score 701.8147903827619
2025-05-14 21:38:28,778 - INFO - Sample index 578 flagged with score 803.1936254727125
2025-05-14 21:38:28,778 - INFO - Sample index 585 flagged with score 1071.8805903644304
2025-05-14 21:38:28,778 - INFO - Sample index 591 flagged with score 1003.2905860218165
2025-05-14 21:38:28,778 - INFO - Sample index 598 flagged with score 1069.9682238272312
2025-05-14 21:38:28,778 - INFO - Sample index 617 flagged with score 1135.436479949451
2025-05-14 21:38:28,778 - INFO - Sample index 638 flagged with score 1797.7052038640818
2025-05-14 21:38:28,778 - INFO - Sample index 639 flagged with score 1868.0984984737822
2025-05-14 21:38:28,778 - INFO - Sample index 640 flagged with score 1433.2285232997563
2025-05-14 21:38:28,778 - INFO - Sample index 641 flagged with score 1797.7052038640818
2025-05-14 21:38:28,778 - INFO - Sample index 642 flagged with score 1132.2755848290644
2025-05-14 21:38:28,778 - INFO - Sample index 647 flagged with score 1917.331478904991
2025-05-14 21:38:28,778 - INFO - Sample index 657 flagged with score 1365.1666564928987
2025-05-14 21:38:28,778 - INFO - Sample index 663 flagged with score 1233.5574571133684
2025-05-14 21:38:28,778 - INFO - Sample index 664 flagged with score 1299.058120331804
2025-05-14 21:38:28,778 - INFO - Sample index 667 flagged with score 1829.885242303462
2025-05-14 21:38:28,778 - INFO - Sample index 680 flagged with score 1481.7071235571489
2025-05-14 21:38:28,778 - INFO - Sample index 681 flagged with score 3096.237716972003
2025-05-14 21:38:28,778 - INFO - Sample index 682 flagged with score 2370.161175954074
2025-05-14 21:38:28,778 - INFO - Sample index 697 flagged with score 3219.778874394948
2025-05-14 21:38:28,778 - INFO - Sample index 699 flagged with score 3279.3365182609728
2025-05-14 21:38:28,778 - INFO - Sample index 707 flagged with score 1112.201420606897
2025-05-14 21:38:28,778 - INFO - Sample index 820 flagged with score 2901421966.065669
2025-05-14 21:38:28,778 - INFO - Sample index 821 flagged with score 2901421966.065649
2025-05-14 21:38:28,778 - INFO - Sample index 822 flagged with score 2901421966.0668354
2025-05-14 21:38:28,778 - INFO - Sample index 823 flagged with score 2901421966.0667386
2025-05-14 21:38:28,778 - INFO - Sample index 838 flagged with score 668.1796165702752
2025-05-14 21:38:28,778 - INFO - Sample index 846 flagged with score 1436.7964365211935
2025-05-14 21:38:28,778 - INFO - Sample index 847 flagged with score 1344.0
2025-05-14 21:38:28,778 - INFO - Sample index 849 flagged with score 1199.0396156924924
2025-05-14 21:38:28,778 - INFO - Sample index 851 flagged with score 1188.7472397444294
2025-05-14 21:38:28,778 - INFO - Sample index 987 flagged with score 1091.7582149908467
2025-05-14 21:38:28,778 - INFO - Model training completed
2025-05-14 21:38:28,778 - INFO - Initializing Isolation Forest and starting training
2025-05-14 21:38:28,847 - INFO - Isolation Forest predicted 107 anomalies out of 1065
2025-05-14 21:38:28,847 - INFO - Initializing ECOD and starting training
2025-05-14 21:38:28,855 - INFO - ECOD predicted 107 anomalies out of 1065
2025-05-14 21:38:28,855 - INFO - Initializing COPOD and starting training
2025-05-14 21:38:28,859 - INFO - COPOD predicted 107 anomalies out of 1065
2025-05-14 21:38:28,859 - INFO - Starting anomaly predictions
2025-05-14 21:38:28,884 - INFO - Predictions array (0 normal, 1 anomaly): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2025-05-14 21:38:28,885 - INFO - Predicted anomalies for 82 out of 1065 samples
2025-05-14 21:38:28,885 - INFO - Returning 82 anomaly indices
2025-05-14 21:38:28,885 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 21:41:37,364 - INFO - 日志系统已初始化
2025-05-14 21:41:40,054 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:41:40,056 - INFO - Received file: traffic_0.csv
2025-05-14 21:41:40,062 - INFO - Loaded DataFrame with 1065 rows and 25 columns
2025-05-14 21:41:40,063 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 1065 rows
2025-05-14 21:41:40,078 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_214140.csv
2025-05-14 21:41:40,080 - INFO - Features retained after VarianceThreshold (16): ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count', 'minute', 'second', 'src_ip_int', 'dst_ip_int', 'src_port', 'dst_port', 'tcp_flag_S', 'tcp_flag_A', 'tcp_flag_F', 'tcp_flag_R', 'tcp_flag_P', 'payload_len']
2025-05-14 21:41:40,080 - INFO - Initializing KNN model and starting training
2025-05-14 21:41:40,108 - INFO - Model decision threshold: 570.2919170197597
2025-05-14 21:41:40,108 - INFO - Decision scores summary – min: 0.0, max: 2901421966.0668354, mean: 10897611.986538371
2025-05-14 21:41:40,108 - INFO - Sample index 20 flagged with score 658.920329023168
2025-05-14 21:41:40,108 - INFO - Sample index 21 flagged with score 658.920329023168
2025-05-14 21:41:40,108 - INFO - Sample index 29 flagged with score 1393.3786276529434
2025-05-14 21:41:40,108 - INFO - Sample index 31 flagged with score 1244.3022140943092
2025-05-14 21:41:40,108 - INFO - Sample index 32 flagged with score 1297.4806356936508
2025-05-14 21:41:40,108 - INFO - Sample index 34 flagged with score 1393.3786276529434
2025-05-14 21:41:40,108 - INFO - Sample index 36 flagged with score 1242.6552216926464
2025-05-14 21:41:40,108 - INFO - Sample index 37 flagged with score 1295.9012308042616
2025-05-14 21:41:40,108 - INFO - Sample index 41 flagged with score 658.920329023168
2025-05-14 21:41:40,108 - INFO - Sample index 55 flagged with score 1393.3786276529434
2025-05-14 21:41:40,108 - INFO - Sample index 59 flagged with score 1297.4806356936508
2025-05-14 21:41:40,108 - INFO - Sample index 60 flagged with score 1242.6552216926464
2025-05-14 21:41:40,108 - INFO - Sample index 95 flagged with score 593.511583711725
2025-05-14 21:41:40,108 - INFO - Sample index 173 flagged with score 1119.5427638102976
2025-05-14 21:41:40,108 - INFO - Sample index 176 flagged with score 1112.201420606897
2025-05-14 21:41:40,108 - INFO - Sample index 203 flagged with score 1104.8112961044524
2025-05-14 21:41:40,108 - INFO - Sample index 263 flagged with score 738.084006058931
2025-05-14 21:41:40,108 - INFO - Sample index 265 flagged with score 2121.6748101440994
2025-05-14 21:41:40,108 - INFO - Sample index 266 flagged with score 1927.4522043360764
2025-05-14 21:41:40,108 - INFO - Sample index 270 flagged with score 1918.3993327771984
2025-05-14 21:41:40,108 - INFO - Sample index 272 flagged with score 1174.8838240438924
2025-05-14 21:41:40,108 - INFO - Sample index 281 flagged with score 1745.1005701678055
2025-05-14 21:41:40,108 - INFO - Sample index 282 flagged with score 1612.7492055493315
2025-05-14 21:41:40,108 - INFO - Sample index 283 flagged with score 1678.704262221312
2025-05-14 21:41:40,108 - INFO - Sample index 284 flagged with score 1546.6298846201053
2025-05-14 21:41:40,108 - INFO - Sample index 289 flagged with score 1142.180371044784
2025-05-14 21:41:40,108 - INFO - Sample index 291 flagged with score 671.237662828897
2025-05-14 21:41:40,108 - INFO - Sample index 292 flagged with score 1216.8418138772188
2025-05-14 21:41:40,108 - INFO - Sample index 293 flagged with score 729.7122720634483
2025-05-14 21:41:40,108 - INFO - Sample index 294 flagged with score 1115.8781295464125
2025-05-14 21:41:40,108 - INFO - Sample index 483 flagged with score 6498.915601852358
2025-05-14 21:41:40,108 - INFO - Sample index 484 flagged with score 3791.020970662125
2025-05-14 21:41:40,108 - INFO - Sample index 485 flagged with score 5145.038775364089
2025-05-14 21:41:40,108 - INFO - Sample index 486 flagged with score 3791.156024222691
2025-05-14 21:41:40,108 - INFO - Sample index 487 flagged with score 3810.419399488723
2025-05-14 21:41:40,108 - INFO - Sample index 488 flagged with score 3791.020970662125
2025-05-14 21:41:40,109 - INFO - Sample index 489 flagged with score 3791.156024222691
2025-05-14 21:41:40,109 - INFO - Sample index 490 flagged with score 4061.9837518138843
2025-05-14 21:41:40,109 - INFO - Sample index 491 flagged with score 4062.1097966450884
2025-05-14 21:41:40,109 - INFO - Sample index 492 flagged with score 4062.1097966450884
2025-05-14 21:41:40,109 - INFO - Sample index 509 flagged with score 4061.9837518138843
2025-05-14 21:41:40,109 - INFO - Sample index 511 flagged with score 4062.1097966450884
2025-05-14 21:41:40,109 - INFO - Sample index 512 flagged with score 4061.9837518138843
2025-05-14 21:41:40,109 - INFO - Sample index 513 flagged with score 4062.1097966450884
2025-05-14 21:41:40,109 - INFO - Sample index 515 flagged with score 4061.8577030713423
2025-05-14 21:41:40,109 - INFO - Sample index 517 flagged with score 4061.9837518138843
2025-05-14 21:41:40,109 - INFO - Sample index 518 flagged with score 4061.8577030713423
2025-05-14 21:41:40,109 - INFO - Sample index 519 flagged with score 4061.8577030713423
2025-05-14 21:41:40,109 - INFO - Sample index 520 flagged with score 4061.7316504170976
2025-05-14 21:41:40,109 - INFO - Sample index 521 flagged with score 4061.8577030713423
2025-05-14 21:41:40,109 - INFO - Sample index 522 flagged with score 4061.9837518138843
2025-05-14 21:41:40,109 - INFO - Sample index 523 flagged with score 4061.7316504170976
2025-05-14 21:41:40,109 - INFO - Sample index 524 flagged with score 4061.7316504170976
2025-05-14 21:41:40,109 - INFO - Sample index 525 flagged with score 4061.7316504170976
2025-05-14 21:41:40,109 - INFO - Sample index 526 flagged with score 4061.9837518138843
2025-05-14 21:41:40,109 - INFO - Sample index 527 flagged with score 4061.9837518138843
2025-05-14 21:41:40,109 - INFO - Sample index 528 flagged with score 4062.1097966450884
2025-05-14 21:41:40,109 - INFO - Sample index 529 flagged with score 4061.7316504170976
2025-05-14 21:41:40,109 - INFO - Sample index 530 flagged with score 4061.9837518138843
2025-05-14 21:41:40,109 - INFO - Sample index 531 flagged with score 4061.9837518138843
2025-05-14 21:41:40,109 - INFO - Sample index 542 flagged with score 665.1075101064489
2025-05-14 21:41:40,109 - INFO - Sample index 551 flagged with score 1390.4359028736276
2025-05-14 21:41:40,109 - INFO - Sample index 553 flagged with score 1299.058120331804
2025-05-14 21:41:40,109 - INFO - Sample index 555 flagged with score 1241.0060434985803
2025-05-14 21:41:40,109 - INFO - Sample index 557 flagged with score 4061.9837518138843
2025-05-14 21:41:40,109 - INFO - Sample index 558 flagged with score 4061.8577030713423
2025-05-14 21:41:40,109 - INFO - Sample index 559 flagged with score 667.4129156676547
2025-05-14 21:41:40,109 - INFO - Sample index 560 flagged with score 4061.8577030713423
2025-05-14 21:41:40,109 - INFO - Sample index 561 flagged with score 3547.817357193011
2025-05-14 21:41:40,109 - INFO - Sample index 562 flagged with score 2042.7432535685928
2025-05-14 21:41:40,109 - INFO - Sample index 563 flagged with score 2815.4544926174885
2025-05-14 21:41:40,109 - INFO - Sample index 564 flagged with score 770.6620530427069
2025-05-14 21:41:40,109 - INFO - Sample index 565 flagged with score 970.6080568385985
2025-05-14 21:41:40,109 - INFO - Sample index 566 flagged with score 736.0
2025-05-14 21:41:40,109 - INFO - Sample index 567 flagged with score 676.5559843797112
2025-05-14 21:41:40,109 - INFO - Sample index 570 flagged with score 701.8147903827619
2025-05-14 21:41:40,109 - INFO - Sample index 578 flagged with score 803.1936254727125
2025-05-14 21:41:40,109 - INFO - Sample index 585 flagged with score 1071.8805903644304
2025-05-14 21:41:40,109 - INFO - Sample index 591 flagged with score 1003.2905860218165
2025-05-14 21:41:40,109 - INFO - Sample index 598 flagged with score 1069.9682238272312
2025-05-14 21:41:40,109 - INFO - Sample index 617 flagged with score 1135.436479949451
2025-05-14 21:41:40,109 - INFO - Sample index 638 flagged with score 1797.7052038640818
2025-05-14 21:41:40,109 - INFO - Sample index 639 flagged with score 1868.0984984737822
2025-05-14 21:41:40,109 - INFO - Sample index 640 flagged with score 1433.2285232997563
2025-05-14 21:41:40,109 - INFO - Sample index 641 flagged with score 1797.7052038640818
2025-05-14 21:41:40,109 - INFO - Sample index 642 flagged with score 1132.2755848290644
2025-05-14 21:41:40,109 - INFO - Sample index 647 flagged with score 1917.331478904991
2025-05-14 21:41:40,109 - INFO - Sample index 657 flagged with score 1365.1666564928987
2025-05-14 21:41:40,109 - INFO - Sample index 663 flagged with score 1233.5574571133684
2025-05-14 21:41:40,109 - INFO - Sample index 664 flagged with score 1299.058120331804
2025-05-14 21:41:40,109 - INFO - Sample index 667 flagged with score 1829.885242303462
2025-05-14 21:41:40,109 - INFO - Sample index 680 flagged with score 1481.7071235571489
2025-05-14 21:41:40,109 - INFO - Sample index 681 flagged with score 3096.237716972003
2025-05-14 21:41:40,109 - INFO - Sample index 682 flagged with score 2370.161175954074
2025-05-14 21:41:40,109 - INFO - Sample index 697 flagged with score 3219.778874394948
2025-05-14 21:41:40,109 - INFO - Sample index 699 flagged with score 3279.3365182609728
2025-05-14 21:41:40,109 - INFO - Sample index 707 flagged with score 1112.201420606897
2025-05-14 21:41:40,109 - INFO - Sample index 820 flagged with score 2901421966.065669
2025-05-14 21:41:40,109 - INFO - Sample index 821 flagged with score 2901421966.065649
2025-05-14 21:41:40,109 - INFO - Sample index 822 flagged with score 2901421966.0668354
2025-05-14 21:41:40,109 - INFO - Sample index 823 flagged with score 2901421966.0667386
2025-05-14 21:41:40,109 - INFO - Sample index 838 flagged with score 668.1796165702752
2025-05-14 21:41:40,109 - INFO - Sample index 846 flagged with score 1436.7964365211935
2025-05-14 21:41:40,109 - INFO - Sample index 847 flagged with score 1344.0
2025-05-14 21:41:40,109 - INFO - Sample index 849 flagged with score 1199.0396156924924
2025-05-14 21:41:40,109 - INFO - Sample index 851 flagged with score 1188.7472397444294
2025-05-14 21:41:40,109 - INFO - Sample index 987 flagged with score 1091.7582149908467
2025-05-14 21:41:40,109 - INFO - Model training completed
2025-05-14 21:41:40,109 - INFO - Initializing Isolation Forest and starting training
2025-05-14 21:41:40,178 - INFO - Isolation Forest predicted 107 anomalies out of 1065
2025-05-14 21:41:40,178 - INFO - Initializing ECOD and starting training
2025-05-14 21:41:40,365 - INFO - ECOD predicted 107 anomalies out of 1065
2025-05-14 21:41:40,365 - INFO - Initializing COPOD and starting training
2025-05-14 21:41:40,369 - INFO - COPOD predicted 107 anomalies out of 1065
2025-05-14 21:41:40,369 - INFO - Starting anomaly predictions
2025-05-14 21:41:40,393 - INFO - Predictions array (0 normal, 1 anomaly): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2025-05-14 21:41:40,393 - INFO - Predicted anomalies for 82 out of 1065 samples
2025-05-14 21:41:40,393 - INFO - Returning 82 anomaly indices
2025-05-14 21:41:40,394 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 21:43:41,552 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:43:41,554 - INFO - Received file: traffic_0.csv
2025-05-14 21:43:41,560 - INFO - Loaded DataFrame with 1065 rows and 25 columns
2025-05-14 21:43:41,561 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 1065 rows
2025-05-14 21:43:41,574 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_214341.csv
2025-05-14 21:43:41,575 - INFO - Features retained after VarianceThreshold (16): ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count', 'minute', 'second', 'src_ip_int', 'dst_ip_int', 'src_port', 'dst_port', 'tcp_flag_S', 'tcp_flag_A', 'tcp_flag_F', 'tcp_flag_R', 'tcp_flag_P', 'payload_len']
2025-05-14 21:43:41,575 - INFO - Initializing KNN model and starting training
2025-05-14 21:43:41,579 - INFO - Model decision threshold: 570.2919170197597
2025-05-14 21:43:41,579 - INFO - Decision scores summary – min: 0.0, max: 2901421966.0668354, mean: 10897611.986538371
2025-05-14 21:43:41,579 - INFO - Sample index 20 flagged with score 658.920329023168
2025-05-14 21:43:41,579 - INFO - Sample index 21 flagged with score 658.920329023168
2025-05-14 21:43:41,579 - INFO - Sample index 29 flagged with score 1393.3786276529434
2025-05-14 21:43:41,579 - INFO - Sample index 31 flagged with score 1244.3022140943092
2025-05-14 21:43:41,579 - INFO - Sample index 32 flagged with score 1297.4806356936508
2025-05-14 21:43:41,579 - INFO - Sample index 34 flagged with score 1393.3786276529434
2025-05-14 21:43:41,579 - INFO - Sample index 36 flagged with score 1242.6552216926464
2025-05-14 21:43:41,579 - INFO - Sample index 37 flagged with score 1295.9012308042616
2025-05-14 21:43:41,579 - INFO - Sample index 41 flagged with score 658.920329023168
2025-05-14 21:43:41,579 - INFO - Sample index 55 flagged with score 1393.3786276529434
2025-05-14 21:43:41,579 - INFO - Sample index 59 flagged with score 1297.4806356936508
2025-05-14 21:43:41,579 - INFO - Sample index 60 flagged with score 1242.6552216926464
2025-05-14 21:43:41,579 - INFO - Sample index 95 flagged with score 593.511583711725
2025-05-14 21:43:41,579 - INFO - Sample index 173 flagged with score 1119.5427638102976
2025-05-14 21:43:41,579 - INFO - Sample index 176 flagged with score 1112.201420606897
2025-05-14 21:43:41,579 - INFO - Sample index 203 flagged with score 1104.8112961044524
2025-05-14 21:43:41,579 - INFO - Sample index 263 flagged with score 738.084006058931
2025-05-14 21:43:41,579 - INFO - Sample index 265 flagged with score 2121.6748101440994
2025-05-14 21:43:41,579 - INFO - Sample index 266 flagged with score 1927.4522043360764
2025-05-14 21:43:41,579 - INFO - Sample index 270 flagged with score 1918.3993327771984
2025-05-14 21:43:41,579 - INFO - Sample index 272 flagged with score 1174.8838240438924
2025-05-14 21:43:41,579 - INFO - Sample index 281 flagged with score 1745.1005701678055
2025-05-14 21:43:41,579 - INFO - Sample index 282 flagged with score 1612.7492055493315
2025-05-14 21:43:41,579 - INFO - Sample index 283 flagged with score 1678.704262221312
2025-05-14 21:43:41,579 - INFO - Sample index 284 flagged with score 1546.6298846201053
2025-05-14 21:43:41,579 - INFO - Sample index 289 flagged with score 1142.180371044784
2025-05-14 21:43:41,579 - INFO - Sample index 291 flagged with score 671.237662828897
2025-05-14 21:43:41,579 - INFO - Sample index 292 flagged with score 1216.8418138772188
2025-05-14 21:43:41,579 - INFO - Sample index 293 flagged with score 729.7122720634483
2025-05-14 21:43:41,579 - INFO - Sample index 294 flagged with score 1115.8781295464125
2025-05-14 21:43:41,579 - INFO - Sample index 483 flagged with score 6498.915601852358
2025-05-14 21:43:41,579 - INFO - Sample index 484 flagged with score 3791.020970662125
2025-05-14 21:43:41,579 - INFO - Sample index 485 flagged with score 5145.038775364089
2025-05-14 21:43:41,580 - INFO - Sample index 486 flagged with score 3791.156024222691
2025-05-14 21:43:41,580 - INFO - Sample index 487 flagged with score 3810.419399488723
2025-05-14 21:43:41,580 - INFO - Sample index 488 flagged with score 3791.020970662125
2025-05-14 21:43:41,580 - INFO - Sample index 489 flagged with score 3791.156024222691
2025-05-14 21:43:41,580 - INFO - Sample index 490 flagged with score 4061.9837518138843
2025-05-14 21:43:41,580 - INFO - Sample index 491 flagged with score 4062.1097966450884
2025-05-14 21:43:41,580 - INFO - Sample index 492 flagged with score 4062.1097966450884
2025-05-14 21:43:41,580 - INFO - Sample index 509 flagged with score 4061.9837518138843
2025-05-14 21:43:41,580 - INFO - Sample index 511 flagged with score 4062.1097966450884
2025-05-14 21:43:41,580 - INFO - Sample index 512 flagged with score 4061.9837518138843
2025-05-14 21:43:41,580 - INFO - Sample index 513 flagged with score 4062.1097966450884
2025-05-14 21:43:41,580 - INFO - Sample index 515 flagged with score 4061.8577030713423
2025-05-14 21:43:41,580 - INFO - Sample index 517 flagged with score 4061.9837518138843
2025-05-14 21:43:41,580 - INFO - Sample index 518 flagged with score 4061.8577030713423
2025-05-14 21:43:41,580 - INFO - Sample index 519 flagged with score 4061.8577030713423
2025-05-14 21:43:41,580 - INFO - Sample index 520 flagged with score 4061.7316504170976
2025-05-14 21:43:41,580 - INFO - Sample index 521 flagged with score 4061.8577030713423
2025-05-14 21:43:41,580 - INFO - Sample index 522 flagged with score 4061.9837518138843
2025-05-14 21:43:41,580 - INFO - Sample index 523 flagged with score 4061.7316504170976
2025-05-14 21:43:41,580 - INFO - Sample index 524 flagged with score 4061.7316504170976
2025-05-14 21:43:41,580 - INFO - Sample index 525 flagged with score 4061.7316504170976
2025-05-14 21:43:41,580 - INFO - Sample index 526 flagged with score 4061.9837518138843
2025-05-14 21:43:41,580 - INFO - Sample index 527 flagged with score 4061.9837518138843
2025-05-14 21:43:41,580 - INFO - Sample index 528 flagged with score 4062.1097966450884
2025-05-14 21:43:41,580 - INFO - Sample index 529 flagged with score 4061.7316504170976
2025-05-14 21:43:41,580 - INFO - Sample index 530 flagged with score 4061.9837518138843
2025-05-14 21:43:41,580 - INFO - Sample index 531 flagged with score 4061.9837518138843
2025-05-14 21:43:41,580 - INFO - Sample index 542 flagged with score 665.1075101064489
2025-05-14 21:43:41,580 - INFO - Sample index 551 flagged with score 1390.4359028736276
2025-05-14 21:43:41,580 - INFO - Sample index 553 flagged with score 1299.058120331804
2025-05-14 21:43:41,580 - INFO - Sample index 555 flagged with score 1241.0060434985803
2025-05-14 21:43:41,580 - INFO - Sample index 557 flagged with score 4061.9837518138843
2025-05-14 21:43:41,580 - INFO - Sample index 558 flagged with score 4061.8577030713423
2025-05-14 21:43:41,580 - INFO - Sample index 559 flagged with score 667.4129156676547
2025-05-14 21:43:41,580 - INFO - Sample index 560 flagged with score 4061.8577030713423
2025-05-14 21:43:41,580 - INFO - Sample index 561 flagged with score 3547.817357193011
2025-05-14 21:43:41,580 - INFO - Sample index 562 flagged with score 2042.7432535685928
2025-05-14 21:43:41,580 - INFO - Sample index 563 flagged with score 2815.4544926174885
2025-05-14 21:43:41,580 - INFO - Sample index 564 flagged with score 770.6620530427069
2025-05-14 21:43:41,580 - INFO - Sample index 565 flagged with score 970.6080568385985
2025-05-14 21:43:41,580 - INFO - Sample index 566 flagged with score 736.0
2025-05-14 21:43:41,580 - INFO - Sample index 567 flagged with score 676.5559843797112
2025-05-14 21:43:41,580 - INFO - Sample index 570 flagged with score 701.8147903827619
2025-05-14 21:43:41,580 - INFO - Sample index 578 flagged with score 803.1936254727125
2025-05-14 21:43:41,580 - INFO - Sample index 585 flagged with score 1071.8805903644304
2025-05-14 21:43:41,580 - INFO - Sample index 591 flagged with score 1003.2905860218165
2025-05-14 21:43:41,580 - INFO - Sample index 598 flagged with score 1069.9682238272312
2025-05-14 21:43:41,580 - INFO - Sample index 617 flagged with score 1135.436479949451
2025-05-14 21:43:41,580 - INFO - Sample index 638 flagged with score 1797.7052038640818
2025-05-14 21:43:41,580 - INFO - Sample index 639 flagged with score 1868.0984984737822
2025-05-14 21:43:41,580 - INFO - Sample index 640 flagged with score 1433.2285232997563
2025-05-14 21:43:41,580 - INFO - Sample index 641 flagged with score 1797.7052038640818
2025-05-14 21:43:41,580 - INFO - Sample index 642 flagged with score 1132.2755848290644
2025-05-14 21:43:41,580 - INFO - Sample index 647 flagged with score 1917.331478904991
2025-05-14 21:43:41,580 - INFO - Sample index 657 flagged with score 1365.1666564928987
2025-05-14 21:43:41,580 - INFO - Sample index 663 flagged with score 1233.5574571133684
2025-05-14 21:43:41,580 - INFO - Sample index 664 flagged with score 1299.058120331804
2025-05-14 21:43:41,580 - INFO - Sample index 667 flagged with score 1829.885242303462
2025-05-14 21:43:41,580 - INFO - Sample index 680 flagged with score 1481.7071235571489
2025-05-14 21:43:41,580 - INFO - Sample index 681 flagged with score 3096.237716972003
2025-05-14 21:43:41,580 - INFO - Sample index 682 flagged with score 2370.161175954074
2025-05-14 21:43:41,580 - INFO - Sample index 697 flagged with score 3219.778874394948
2025-05-14 21:43:41,580 - INFO - Sample index 699 flagged with score 3279.3365182609728
2025-05-14 21:43:41,580 - INFO - Sample index 707 flagged with score 1112.201420606897
2025-05-14 21:43:41,580 - INFO - Sample index 820 flagged with score 2901421966.065669
2025-05-14 21:43:41,580 - INFO - Sample index 821 flagged with score 2901421966.065649
2025-05-14 21:43:41,580 - INFO - Sample index 822 flagged with score 2901421966.0668354
2025-05-14 21:43:41,580 - INFO - Sample index 823 flagged with score 2901421966.0667386
2025-05-14 21:43:41,580 - INFO - Sample index 838 flagged with score 668.1796165702752
2025-05-14 21:43:41,580 - INFO - Sample index 846 flagged with score 1436.7964365211935
2025-05-14 21:43:41,580 - INFO - Sample index 847 flagged with score 1344.0
2025-05-14 21:43:41,580 - INFO - Sample index 849 flagged with score 1199.0396156924924
2025-05-14 21:43:41,580 - INFO - Sample index 851 flagged with score 1188.7472397444294
2025-05-14 21:43:41,580 - INFO - Sample index 987 flagged with score 1091.7582149908467
2025-05-14 21:43:41,580 - INFO - Model training completed
2025-05-14 21:43:41,580 - INFO - Initializing Isolation Forest and starting training
2025-05-14 21:43:41,649 - INFO - Isolation Forest predicted 107 anomalies out of 1065
2025-05-14 21:43:41,649 - INFO - Initializing ECOD and starting training
2025-05-14 21:43:41,654 - INFO - ECOD predicted 107 anomalies out of 1065
2025-05-14 21:43:41,654 - INFO - Initializing COPOD and starting training
2025-05-14 21:43:41,659 - INFO - COPOD predicted 107 anomalies out of 1065
2025-05-14 21:43:41,659 - INFO - Starting anomaly predictions
2025-05-14 21:43:41,684 - INFO - Predictions array (0 normal, 1 anomaly): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2025-05-14 21:43:41,684 - INFO - Predicted anomalies for 82 out of 1065 samples
2025-05-14 21:43:41,684 - INFO - Returning 82 anomaly indices
2025-05-14 21:43:41,685 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 21:44:12,240 - INFO - 日志系统已初始化
2025-05-14 21:44:23,675 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:44:23,677 - INFO - Received file: traffic_0.csv
2025-05-14 21:44:23,683 - INFO - Loaded DataFrame with 1065 rows and 25 columns
2025-05-14 21:44:23,683 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 1065 rows
2025-05-14 21:44:23,698 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_214423.csv
2025-05-14 21:44:23,699 - INFO - Features retained after VarianceThreshold (16): ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count', 'minute', 'second', 'src_ip_int', 'dst_ip_int', 'src_port', 'dst_port', 'tcp_flag_S', 'tcp_flag_A', 'tcp_flag_F', 'tcp_flag_R', 'tcp_flag_P', 'payload_len']
2025-05-14 21:44:23,699 - INFO - Initializing KNN model and starting training
2025-05-14 21:44:23,724 - INFO - Model decision threshold: 570.2919170197597
2025-05-14 21:44:23,724 - INFO - Decision scores summary – min: 0.0, max: 2901421966.0668354, mean: 10897611.986538371
2025-05-14 21:44:23,724 - INFO - Sample index 20 flagged with score 658.920329023168
2025-05-14 21:44:23,724 - INFO - Sample index 21 flagged with score 658.920329023168
2025-05-14 21:44:23,724 - INFO - Sample index 29 flagged with score 1393.3786276529434
2025-05-14 21:44:23,724 - INFO - Sample index 31 flagged with score 1244.3022140943092
2025-05-14 21:44:23,724 - INFO - Sample index 32 flagged with score 1297.4806356936508
2025-05-14 21:44:23,724 - INFO - Sample index 34 flagged with score 1393.3786276529434
2025-05-14 21:44:23,724 - INFO - Sample index 36 flagged with score 1242.6552216926464
2025-05-14 21:44:23,724 - INFO - Sample index 37 flagged with score 1295.9012308042616
2025-05-14 21:44:23,724 - INFO - Sample index 41 flagged with score 658.920329023168
2025-05-14 21:44:23,724 - INFO - Sample index 55 flagged with score 1393.3786276529434
2025-05-14 21:44:23,724 - INFO - Sample index 59 flagged with score 1297.4806356936508
2025-05-14 21:44:23,724 - INFO - Sample index 60 flagged with score 1242.6552216926464
2025-05-14 21:44:23,724 - INFO - Sample index 95 flagged with score 593.511583711725
2025-05-14 21:44:23,724 - INFO - Sample index 173 flagged with score 1119.5427638102976
2025-05-14 21:44:23,724 - INFO - Sample index 176 flagged with score 1112.201420606897
2025-05-14 21:44:23,724 - INFO - Sample index 203 flagged with score 1104.8112961044524
2025-05-14 21:44:23,724 - INFO - Sample index 263 flagged with score 738.084006058931
2025-05-14 21:44:23,724 - INFO - Sample index 265 flagged with score 2121.6748101440994
2025-05-14 21:44:23,724 - INFO - Sample index 266 flagged with score 1927.4522043360764
2025-05-14 21:44:23,724 - INFO - Sample index 270 flagged with score 1918.3993327771984
2025-05-14 21:44:23,724 - INFO - Sample index 272 flagged with score 1174.8838240438924
2025-05-14 21:44:23,724 - INFO - Sample index 281 flagged with score 1745.1005701678055
2025-05-14 21:44:23,724 - INFO - Sample index 282 flagged with score 1612.7492055493315
2025-05-14 21:44:23,724 - INFO - Sample index 283 flagged with score 1678.704262221312
2025-05-14 21:44:23,724 - INFO - Sample index 284 flagged with score 1546.6298846201053
2025-05-14 21:44:23,724 - INFO - Sample index 289 flagged with score 1142.180371044784
2025-05-14 21:44:23,724 - INFO - Sample index 291 flagged with score 671.237662828897
2025-05-14 21:44:23,724 - INFO - Sample index 292 flagged with score 1216.8418138772188
2025-05-14 21:44:23,724 - INFO - Sample index 293 flagged with score 729.7122720634483
2025-05-14 21:44:23,724 - INFO - Sample index 294 flagged with score 1115.8781295464125
2025-05-14 21:44:23,725 - INFO - Sample index 483 flagged with score 6498.915601852358
2025-05-14 21:44:23,725 - INFO - Sample index 484 flagged with score 3791.020970662125
2025-05-14 21:44:23,725 - INFO - Sample index 485 flagged with score 5145.038775364089
2025-05-14 21:44:23,725 - INFO - Sample index 486 flagged with score 3791.156024222691
2025-05-14 21:44:23,725 - INFO - Sample index 487 flagged with score 3810.419399488723
2025-05-14 21:44:23,725 - INFO - Sample index 488 flagged with score 3791.020970662125
2025-05-14 21:44:23,725 - INFO - Sample index 489 flagged with score 3791.156024222691
2025-05-14 21:44:23,725 - INFO - Sample index 490 flagged with score 4061.9837518138843
2025-05-14 21:44:23,725 - INFO - Sample index 491 flagged with score 4062.1097966450884
2025-05-14 21:44:23,725 - INFO - Sample index 492 flagged with score 4062.1097966450884
2025-05-14 21:44:23,725 - INFO - Sample index 509 flagged with score 4061.9837518138843
2025-05-14 21:44:23,725 - INFO - Sample index 511 flagged with score 4062.1097966450884
2025-05-14 21:44:23,725 - INFO - Sample index 512 flagged with score 4061.9837518138843
2025-05-14 21:44:23,725 - INFO - Sample index 513 flagged with score 4062.1097966450884
2025-05-14 21:44:23,725 - INFO - Sample index 515 flagged with score 4061.8577030713423
2025-05-14 21:44:23,725 - INFO - Sample index 517 flagged with score 4061.9837518138843
2025-05-14 21:44:23,725 - INFO - Sample index 518 flagged with score 4061.8577030713423
2025-05-14 21:44:23,725 - INFO - Sample index 519 flagged with score 4061.8577030713423
2025-05-14 21:44:23,725 - INFO - Sample index 520 flagged with score 4061.7316504170976
2025-05-14 21:44:23,725 - INFO - Sample index 521 flagged with score 4061.8577030713423
2025-05-14 21:44:23,725 - INFO - Sample index 522 flagged with score 4061.9837518138843
2025-05-14 21:44:23,725 - INFO - Sample index 523 flagged with score 4061.7316504170976
2025-05-14 21:44:23,725 - INFO - Sample index 524 flagged with score 4061.7316504170976
2025-05-14 21:44:23,725 - INFO - Sample index 525 flagged with score 4061.7316504170976
2025-05-14 21:44:23,725 - INFO - Sample index 526 flagged with score 4061.9837518138843
2025-05-14 21:44:23,725 - INFO - Sample index 527 flagged with score 4061.9837518138843
2025-05-14 21:44:23,725 - INFO - Sample index 528 flagged with score 4062.1097966450884
2025-05-14 21:44:23,725 - INFO - Sample index 529 flagged with score 4061.7316504170976
2025-05-14 21:44:23,725 - INFO - Sample index 530 flagged with score 4061.9837518138843
2025-05-14 21:44:23,725 - INFO - Sample index 531 flagged with score 4061.9837518138843
2025-05-14 21:44:23,725 - INFO - Sample index 542 flagged with score 665.1075101064489
2025-05-14 21:44:23,725 - INFO - Sample index 551 flagged with score 1390.4359028736276
2025-05-14 21:44:23,725 - INFO - Sample index 553 flagged with score 1299.058120331804
2025-05-14 21:44:23,725 - INFO - Sample index 555 flagged with score 1241.0060434985803
2025-05-14 21:44:23,725 - INFO - Sample index 557 flagged with score 4061.9837518138843
2025-05-14 21:44:23,725 - INFO - Sample index 558 flagged with score 4061.8577030713423
2025-05-14 21:44:23,725 - INFO - Sample index 559 flagged with score 667.4129156676547
2025-05-14 21:44:23,725 - INFO - Sample index 560 flagged with score 4061.8577030713423
2025-05-14 21:44:23,725 - INFO - Sample index 561 flagged with score 3547.817357193011
2025-05-14 21:44:23,725 - INFO - Sample index 562 flagged with score 2042.7432535685928
2025-05-14 21:44:23,725 - INFO - Sample index 563 flagged with score 2815.4544926174885
2025-05-14 21:44:23,725 - INFO - Sample index 564 flagged with score 770.6620530427069
2025-05-14 21:44:23,725 - INFO - Sample index 565 flagged with score 970.6080568385985
2025-05-14 21:44:23,725 - INFO - Sample index 566 flagged with score 736.0
2025-05-14 21:44:23,725 - INFO - Sample index 567 flagged with score 676.5559843797112
2025-05-14 21:44:23,725 - INFO - Sample index 570 flagged with score 701.8147903827619
2025-05-14 21:44:23,725 - INFO - Sample index 578 flagged with score 803.1936254727125
2025-05-14 21:44:23,725 - INFO - Sample index 585 flagged with score 1071.8805903644304
2025-05-14 21:44:23,725 - INFO - Sample index 591 flagged with score 1003.2905860218165
2025-05-14 21:44:23,725 - INFO - Sample index 598 flagged with score 1069.9682238272312
2025-05-14 21:44:23,725 - INFO - Sample index 617 flagged with score 1135.436479949451
2025-05-14 21:44:23,725 - INFO - Sample index 638 flagged with score 1797.7052038640818
2025-05-14 21:44:23,725 - INFO - Sample index 639 flagged with score 1868.0984984737822
2025-05-14 21:44:23,725 - INFO - Sample index 640 flagged with score 1433.2285232997563
2025-05-14 21:44:23,725 - INFO - Sample index 641 flagged with score 1797.7052038640818
2025-05-14 21:44:23,725 - INFO - Sample index 642 flagged with score 1132.2755848290644
2025-05-14 21:44:23,725 - INFO - Sample index 647 flagged with score 1917.331478904991
2025-05-14 21:44:23,725 - INFO - Sample index 657 flagged with score 1365.1666564928987
2025-05-14 21:44:23,725 - INFO - Sample index 663 flagged with score 1233.5574571133684
2025-05-14 21:44:23,725 - INFO - Sample index 664 flagged with score 1299.058120331804
2025-05-14 21:44:23,725 - INFO - Sample index 667 flagged with score 1829.885242303462
2025-05-14 21:44:23,725 - INFO - Sample index 680 flagged with score 1481.7071235571489
2025-05-14 21:44:23,725 - INFO - Sample index 681 flagged with score 3096.237716972003
2025-05-14 21:44:23,725 - INFO - Sample index 682 flagged with score 2370.161175954074
2025-05-14 21:44:23,725 - INFO - Sample index 697 flagged with score 3219.778874394948
2025-05-14 21:44:23,725 - INFO - Sample index 699 flagged with score 3279.3365182609728
2025-05-14 21:44:23,725 - INFO - Sample index 707 flagged with score 1112.201420606897
2025-05-14 21:44:23,725 - INFO - Sample index 820 flagged with score 2901421966.065669
2025-05-14 21:44:23,725 - INFO - Sample index 821 flagged with score 2901421966.065649
2025-05-14 21:44:23,725 - INFO - Sample index 822 flagged with score 2901421966.0668354
2025-05-14 21:44:23,725 - INFO - Sample index 823 flagged with score 2901421966.0667386
2025-05-14 21:44:23,725 - INFO - Sample index 838 flagged with score 668.1796165702752
2025-05-14 21:44:23,725 - INFO - Sample index 846 flagged with score 1436.7964365211935
2025-05-14 21:44:23,725 - INFO - Sample index 847 flagged with score 1344.0
2025-05-14 21:44:23,725 - INFO - Sample index 849 flagged with score 1199.0396156924924
2025-05-14 21:44:23,725 - INFO - Sample index 851 flagged with score 1188.7472397444294
2025-05-14 21:44:23,725 - INFO - Sample index 987 flagged with score 1091.7582149908467
2025-05-14 21:44:23,725 - INFO - Model training completed
2025-05-14 21:44:23,725 - INFO - Initializing Isolation Forest and starting training
2025-05-14 21:44:23,795 - INFO - Isolation Forest predicted 107 anomalies out of 1065
2025-05-14 21:44:23,795 - INFO - Initializing ECOD and starting training
2025-05-14 21:44:23,980 - INFO - ECOD predicted 107 anomalies out of 1065
2025-05-14 21:44:23,980 - INFO - Initializing COPOD and starting training
2025-05-14 21:44:23,985 - INFO - COPOD predicted 107 anomalies out of 1065
2025-05-14 21:44:23,985 - INFO - Starting anomaly predictions
2025-05-14 21:44:24,008 - INFO - Predictions array (0 normal, 1 anomaly): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2025-05-14 21:44:24,008 - INFO - Predicted anomalies for 82 out of 1065 samples
2025-05-14 21:44:24,008 - INFO - Returning 82 anomaly indices
2025-05-14 21:44:24,009 - INFO - Anomaly details with scores: [{'index': 95, 'knn_score': 593.511583711725, 'iforest_score': -0.04849171350422665, 'ecod_score': 13.8217807265416, 'copod_score': 12.579223324584413}, {'index': 263, 'knn_score': 738.084006058931, 'iforest_score': -0.015759149343283818, 'ecod_score': 14.542674844286768, 'copod_score': 13.804621380023347}, {'index': 265, 'knn_score': 2121.6748101440994, 'iforest_score': 0.013283102180082329, 'ecod_score': 16.68458495357242, 'copod_score': 14.544106697079993}, {'index': 266, 'knn_score': 1927.4522043360764, 'iforest_score': -0.011682384495646847, 'ecod_score': 17.712877438162863, 'copod_score': 14.925543372318732}, {'index': 270, 'knn_score': 1918.3993327771984, 'iforest_score': -0.02487949193932959, 'ecod_score': 15.243035798683803, 'copod_score': 14.366488415098765}, {'index': 272, 'knn_score': 1174.8838240438924, 'iforest_score': -0.04018792413307659, 'ecod_score': 15.712885134058093, 'copod_score': 14.540731221568622}, {'index': 281, 'knn_score': 1745.1005701678055, 'iforest_score': -0.15439209311055718, 'ecod_score': 12.319062387256164, 'copod_score': 10.951764007609034}, {'index': 282, 'knn_score': 1612.7492055493315, 'iforest_score': -0.16707002029095191, 'ecod_score': 11.467051071345463, 'copod_score': 9.358837922641985}, {'index': 283, 'knn_score': 1678.704262221312, 'iforest_score': -0.16810724343696126, 'ecod_score': 11.314541156047127, 'copod_score': 9.9472427764}, {'index': 284, 'knn_score': 1546.6298846201053, 'iforest_score': -0.1628483371523488, 'ecod_score': 12.143788221098106, 'copod_score': 9.681361887440913}, {'index': 289, 'knn_score': 1142.180371044784, 'iforest_score': 0.005408562931628724, 'ecod_score': 16.8901323650119, 'copod_score': 16.152078900748478}, {'index': 291, 'knn_score': 671.237662828897, 'iforest_score': -0.1069453272439384, 'ecod_score': 14.069028232175572, 'copod_score': 13.37723082829786}, {'index': 292, 'knn_score': 1216.8418138772188, 'iforest_score': -0.00038266599622860387, 'ecod_score': 16.556783978358986, 'copod_score': 15.818730514095565}, {'index': 293, 'knn_score': 729.7122720634483, 'iforest_score': -0.11491374681921196, 'ecod_score': 11.38286555836887, 'copod_score': 9.835940218259474}, {'index': 294, 'knn_score': 1115.8781295464125, 'iforest_score': -0.12346403050224275, 'ecod_score': 13.833181875262461, 'copod_score': 12.465883495615335}, {'index': 483, 'knn_score': 6498.915601852358, 'iforest_score': 0.023726244270800168, 'ecod_score': 20.895925168181343, 'copod_score': 16.73153414528453}, {'index': 484, 'knn_score': 3791.020970662125, 'iforest_score': 0.005114333966794171, 'ecod_score': 19.97911325818508, 'copod_score': 16.327216374379226}, {'index': 485, 'knn_score': 5145.038775364089, 'iforest_score': 0.007767564402537119, 'ecod_score': 21.05942405175248, 'copod_score': 16.632222518844195}, {'index': 486, 'knn_score': 3791.156024222691, 'iforest_score': 0.006556422896234926, 'ecod_score': 21.16160026275663, 'copod_score': 17.685396973046117}, {'index': 487, 'knn_score': 3810.419399488723, 'iforest_score': 0.017279824025989265, 'ecod_score': 21.497405135782405, 'copod_score': 18.199166329086836}, {'index': 488, 'knn_score': 3791.020970662125, 'iforest_score': -0.004498504960660843, 'ecod_score': 21.08908034713751, 'copod_score': 17.720953458578883}, {'index': 489, 'knn_score': 3791.156024222691, 'iforest_score': 0.006118363995340492, 'ecod_score': 22.114019310905494, 'copod_score': 18.930642402054193}, {'index': 490, 'knn_score': 4061.9837518138843, 'iforest_score': -0.0018628394551495342, 'ecod_score': 21.492750027821405, 'copod_score': 18.20808459492148}, {'index': 491, 'knn_score': 4062.1097966450884, 'iforest_score': 0.0034473880260280643, 'ecod_score': 22.768724064176915, 'copod_score': 19.585347155325614}, {'index': 492, 'knn_score': 4062.1097966450884, 'iforest_score': -0.0011894395386525813, 'ecod_score': 22.202173297695897, 'copod_score': 18.834046409137272}, {'index': 509, 'knn_score': 4061.9837518138843, 'iforest_score': 0.03294885939629888, 'ecod_score': 22.361021824834875, 'copod_score': 20.08802289028631}, {'index': 511, 'knn_score': 4062.1097966450884, 'iforest_score': 0.00966935615423048, 'ecod_score': 22.949905759910486, 'copod_score': 19.934465358854485}, {'index': 512, 'knn_score': 4061.9837518138843, 'iforest_score': 0.00596738495993232, 'ecod_score': 23.46878887150898, 'copod_score': 20.28541196265768}, {'index': 513, 'knn_score': 4062.1097966450884, 'iforest_score': -0.002289419927347658, 'ecod_score': 22.417624503386953, 'copod_score': 19.132959070487026}, {'index': 515, 'knn_score': 4061.8577030713423, 'iforest_score': 0.015294939975608823, 'ecod_score': 21.605471110481833, 'copod_score': 19.33247217593327}, {'index': 517, 'knn_score': 4061.9837518138843, 'iforest_score': 0.015116765388285103, 'ecod_score': 23.4898596565995, 'copod_score': 20.4744192555435}, {'index': 518, 'knn_score': 4061.8577030713423, 'iforest_score': 0.014618012376280576, 'ecod_score': 23.977040228857, 'copod_score': 20.8771247756644}, {'index': 519, 'knn_score': 4061.8577030713423, 'iforest_score': 0.0072234059111978555, 'ecod_score': 23.118464029570053, 'copod_score': 19.75033714101143}, {'index': 520, 'knn_score': 4061.7316504170976, 'iforest_score': 0.01971791202432993, 'ecod_score': 24.938056594981315, 'copod_score': 21.754679686130018}, {'index': 521, 'knn_score': 4061.8577030713423, 'iforest_score': 0.014339019380572027, 'ecod_score': 23.471285404192795, 'copod_score': 20.10315851563417}, {'index': 522, 'knn_score': 4061.9837518138843, 'iforest_score': 0.017188272007888084, 'ecod_score': 23.887800348487545, 'copod_score': 20.519673459928917}, {'index': 523, 'knn_score': 4061.7316504170976, 'iforest_score': 0.018432770944207366, 'ecod_score': 24.46982916513684, 'copod_score': 21.286452256285536}, {'index': 524, 'knn_score': 4061.7316504170976, 'iforest_score': 0.02474332675037194, 'ecod_score': 24.287811605913248, 'copod_score': 21.00314617301332}, {'index': 525, 'knn_score': 4061.7316504170976, 'iforest_score': 0.03229023361123018, 'ecod_score': 24.75703853609081, 'copod_score': 21.55684815532748}, {'index': 526, 'knn_score': 4061.9837518138843, 'iforest_score': 0.021017002276894403, 'ecod_score': 25.519651289635515, 'copod_score': 22.336274380784214}, {'index': 527, 'knn_score': 4061.9837518138843, 'iforest_score': 0.031690781996501105, 'ecod_score': 26.858560208844086, 'copod_score': 23.393879145556845}, {'index': 528, 'knn_score': 4062.1097966450884, 'iforest_score': 0.0356846869924764, 'ecod_score': 25.261672189608877, 'copod_score': 21.977006756708953}, {'index': 529, 'knn_score': 4061.7316504170976, 'iforest_score': 0.02443052678794333, 'ecod_score': 26.07649315068821, 'copod_score': 22.893116241836914}, {'index': 530, 'knn_score': 4061.9837518138843, 'iforest_score': 0.04564641654344537, 'ecod_score': 25.61502129657803, 'copod_score': 22.2468944080194}, {'index': 531, 'knn_score': 4061.9837518138843, 'iforest_score': 0.03440133297413517, 'ecod_score': 26.549270706816674, 'copod_score': 23.365893797965374}, {'index': 557, 'knn_score': 4061.9837518138843, 'iforest_score': 0.0741342145993692, 'ecod_score': 24.9693711713008, 'copod_score': 22.69637223675224}, {'index': 558, 'knn_score': 4061.8577030713423, 'iforest_score': 0.053093618490499206, 'ecod_score': 25.93357039967597, 'copod_score': 23.305156322919398}, {'index': 559, 'knn_score': 667.4129156676547, 'iforest_score': -0.06643736154596896, 'ecod_score': 16.116151138328043, 'copod_score': 13.036908637520296}, {'index': 560, 'knn_score': 4061.8577030713423, 'iforest_score': 0.0771292137293157, 'ecod_score': 25.201774048027808, 'copod_score': 22.928775113479247}, {'index': 561, 'knn_score': 3547.817357193011, 'iforest_score': 0.05141137954490205, 'ecod_score': 26.83183362937114, 'copod_score': 23.860608881893814}, {'index': 562, 'knn_score': 2042.7432535685928, 'iforest_score': 0.06022579209969037, 'ecod_score': 27.570921954348652, 'copod_score': 24.387545045497355}, {'index': 563, 'knn_score': 2815.4544926174885, 'iforest_score': 0.06242317582367107, 'ecod_score': 26.283094839585857, 'copod_score': 23.082904458822533}, {'index': 564, 'knn_score': 770.6620530427069, 'iforest_score': -0.0008380821287843343, 'ecod_score': 20.5314113748585, 'copod_score': 18.081413789434464}, {'index': 565, 'knn_score': 970.6080568385985, 'iforest_score': 0.07713339590548185, 'ecod_score': 27.492116858616598, 'copod_score': 24.308739949765297}, {'index': 566, 'knn_score': 736.0, 'iforest_score': -0.05996391012345692, 'ecod_score': 17.441705819227185, 'copod_score': 13.500639296734983}, {'index': 567, 'knn_score': 676.5559843797112, 'iforest_score': -0.06551328543365614, 'ecod_score': 16.28160493894987, 'copod_score': 13.20236243814212}, {'index': 570, 'knn_score': 701.8147903827619, 'iforest_score': -0.03970509565151281, 'ecod_score': 18.828268577860435, 'copod_score': 16.378270992436395}, {'index': 578, 'knn_score': 803.1936254727125, 'iforest_score': -0.0025912390063396185, 'ecod_score': 20.527412902948456, 'copod_score': 18.077415317524416}, {'index': 585, 'knn_score': 1071.8805903644304, 'iforest_score': 0.003672236243324023, 'ecod_score': 21.559581494560973, 'copod_score': 19.109583909136933}, {'index': 591, 'knn_score': 1003.2905860218165, 'iforest_score': -0.040539935973530006, 'ecod_score': 17.651489399772053, 'copod_score': 14.572246898964305}, {'index': 598, 'knn_score': 1069.9682238272312, 'iforest_score': -0.040539935973530006, 'ecod_score': 17.867920559839234, 'copod_score': 14.788678059031488}, {'index': 617, 'knn_score': 1135.436479949451, 'iforest_score': -0.03540759322463172, 'ecod_score': 18.083088766590635, 'copod_score': 15.00384626578289}, {'index': 638, 'knn_score': 1797.7052038640818, 'iforest_score': -0.034469572545597016, 'ecod_score': 14.124355786884715, 'copod_score': 11.996509181700233}, {'index': 639, 'knn_score': 1868.0984984737822, 'iforest_score': -0.0018099205167928512, 'ecod_score': 16.607527027327134, 'copod_score': 14.299077437260316}, {'index': 640, 'knn_score': 1433.2285232997563, 'iforest_score': -0.031038606562946214, 'ecod_score': 16.132122150382436, 'copod_score': 13.638922580608295}, {'index': 641, 'knn_score': 1797.7052038640818, 'iforest_score': 0.0002551106641524026, 'ecod_score': 17.72448845466344, 'copod_score': 15.416038864596622}, {'index': 642, 'knn_score': 1132.2755848290644, 'iforest_score': -0.046190228147737655, 'ecod_score': 16.246840144151818, 'copod_score': 13.938390554085002}, {'index': 647, 'knn_score': 1917.331478904991, 'iforest_score': -0.049555869405513375, 'ecod_score': 15.247203660401052, 'copod_score': 13.857788767502633}, {'index': 657, 'knn_score': 1365.1666564928987, 'iforest_score': -0.16951151814225845, 'ecod_score': 12.87409961305105, 'copod_score': 10.72353220623692}, {'index': 663, 'knn_score': 1233.5574571133684, 'iforest_score': -0.16743787911544433, 'ecod_score': 12.511986269642616, 'copod_score': 10.361418862828486}, {'index': 664, 'knn_score': 1299.058120331804, 'iforest_score': -0.16993743021476787, 'ecod_score': 13.602699734384679, 'copod_score': 10.357004373560487}, {'index': 667, 'knn_score': 1829.885242303462, 'iforest_score': 0.027159055720717196, 'ecod_score': 18.671407654476422, 'copod_score': 17.150085163046}, {'index': 680, 'knn_score': 1481.7071235571489, 'iforest_score': -0.08443814908192365, 'ecod_score': 15.667837119159868, 'copod_score': 14.146514627729445}, {'index': 681, 'knn_score': 3096.237716972003, 'iforest_score': 0.024914374408086082, 'ecod_score': 18.088444446952355, 'copod_score': 15.952208863945797}, {'index': 682, 'knn_score': 2370.161175954074, 'iforest_score': 0.020511235821338403, 'ecod_score': 18.139395123438085, 'copod_score': 16.433322652300337}, {'index': 697, 'knn_score': 3219.778874394948, 'iforest_score': -0.13134179467321772, 'ecod_score': 13.35860254418042, 'copod_score': 11.20803513736629}, {'index': 699, 'knn_score': 3279.3365182609728, 'iforest_score': -0.12243224062687624, 'ecod_score': 14.67661321868448, 'copod_score': 12.52604581187035}, {'index': 820, 'knn_score': 2901421966.065669, 'iforest_score': 0.030236693998675013, 'ecod_score': 22.301016103124937, 'copod_score': 20.91111273561094}, {'index': 821, 'knn_score': 2901421966.065649, 'iforest_score': -0.01566628769311551, 'ecod_score': 19.61653082492266, 'copod_score': 17.408482588851335}, {'index': 822, 'knn_score': 2901421966.0668354, 'iforest_score': 0.0727094959998662, 'ecod_score': 25.81208430411305, 'copod_score': 23.637182274743743}, {'index': 823, 'knn_score': 2901421966.0667386, 'iforest_score': -0.009769375237517752, 'ecod_score': 19.77348349178192, 'copod_score': 18.16045187779622}, {'index': 851, 'knn_score': 1188.7472397444294, 'iforest_score': 0.016310316572025307, 'ecod_score': 19.452923456253647, 'copod_score': 16.249281643294495}]
2025-05-14 21:44:24,009 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 21:49:48,000 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:49:48,006 - INFO - Received file: traffic_0.csv
2025-05-14 21:49:48,021 - INFO - Loaded DataFrame with 1065 rows and 25 columns
2025-05-14 21:49:48,022 - INFO - Selected features: ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count'], resulting DataFrame has 1065 rows
2025-05-14 21:49:48,047 - INFO - Preprocessed data saved to /Users/recallingrain/Project-Code/PycharmProjects/System/detection/ml/file/preprocessed_20250514_214948.csv
2025-05-14 21:49:48,049 - INFO - Features retained after VarianceThreshold (16): ['inter_arrival', 'packet_length', 'sess_pkt_count', 'sess_byte_count', 'minute', 'second', 'src_ip_int', 'dst_ip_int', 'src_port', 'dst_port', 'tcp_flag_S', 'tcp_flag_A', 'tcp_flag_F', 'tcp_flag_R', 'tcp_flag_P', 'payload_len']
2025-05-14 21:49:48,049 - INFO - Initializing KNN model and starting training
2025-05-14 21:49:48,053 - INFO - Model decision threshold: 570.2919170197597
2025-05-14 21:49:48,053 - INFO - Decision scores summary – min: 0.0, max: 2901421966.0668354, mean: 10897611.986538371
2025-05-14 21:49:48,053 - INFO - Sample index 20 flagged with score 658.920329023168
2025-05-14 21:49:48,053 - INFO - Sample index 21 flagged with score 658.920329023168
2025-05-14 21:49:48,053 - INFO - Sample index 29 flagged with score 1393.3786276529434
2025-05-14 21:49:48,053 - INFO - Sample index 31 flagged with score 1244.3022140943092
2025-05-14 21:49:48,053 - INFO - Sample index 32 flagged with score 1297.4806356936508
2025-05-14 21:49:48,053 - INFO - Sample index 34 flagged with score 1393.3786276529434
2025-05-14 21:49:48,053 - INFO - Sample index 36 flagged with score 1242.6552216926464
2025-05-14 21:49:48,053 - INFO - Sample index 37 flagged with score 1295.9012308042616
2025-05-14 21:49:48,053 - INFO - Sample index 41 flagged with score 658.920329023168
2025-05-14 21:49:48,053 - INFO - Sample index 55 flagged with score 1393.3786276529434
2025-05-14 21:49:48,053 - INFO - Sample index 59 flagged with score 1297.4806356936508
2025-05-14 21:49:48,053 - INFO - Sample index 60 flagged with score 1242.6552216926464
2025-05-14 21:49:48,053 - INFO - Sample index 95 flagged with score 593.511583711725
2025-05-14 21:49:48,053 - INFO - Sample index 173 flagged with score 1119.5427638102976
2025-05-14 21:49:48,053 - INFO - Sample index 176 flagged with score 1112.201420606897
2025-05-14 21:49:48,053 - INFO - Sample index 203 flagged with score 1104.8112961044524
2025-05-14 21:49:48,053 - INFO - Sample index 263 flagged with score 738.084006058931
2025-05-14 21:49:48,053 - INFO - Sample index 265 flagged with score 2121.6748101440994
2025-05-14 21:49:48,053 - INFO - Sample index 266 flagged with score 1927.4522043360764
2025-05-14 21:49:48,053 - INFO - Sample index 270 flagged with score 1918.3993327771984
2025-05-14 21:49:48,053 - INFO - Sample index 272 flagged with score 1174.8838240438924
2025-05-14 21:49:48,053 - INFO - Sample index 281 flagged with score 1745.1005701678055
2025-05-14 21:49:48,053 - INFO - Sample index 282 flagged with score 1612.7492055493315
2025-05-14 21:49:48,053 - INFO - Sample index 283 flagged with score 1678.704262221312
2025-05-14 21:49:48,053 - INFO - Sample index 284 flagged with score 1546.6298846201053
2025-05-14 21:49:48,053 - INFO - Sample index 289 flagged with score 1142.180371044784
2025-05-14 21:49:48,053 - INFO - Sample index 291 flagged with score 671.237662828897
2025-05-14 21:49:48,053 - INFO - Sample index 292 flagged with score 1216.8418138772188
2025-05-14 21:49:48,053 - INFO - Sample index 293 flagged with score 729.7122720634483
2025-05-14 21:49:48,053 - INFO - Sample index 294 flagged with score 1115.8781295464125
2025-05-14 21:49:48,053 - INFO - Sample index 483 flagged with score 6498.915601852358
2025-05-14 21:49:48,053 - INFO - Sample index 484 flagged with score 3791.020970662125
2025-05-14 21:49:48,054 - INFO - Sample index 485 flagged with score 5145.038775364089
2025-05-14 21:49:48,054 - INFO - Sample index 486 flagged with score 3791.156024222691
2025-05-14 21:49:48,054 - INFO - Sample index 487 flagged with score 3810.419399488723
2025-05-14 21:49:48,054 - INFO - Sample index 488 flagged with score 3791.020970662125
2025-05-14 21:49:48,054 - INFO - Sample index 489 flagged with score 3791.156024222691
2025-05-14 21:49:48,054 - INFO - Sample index 490 flagged with score 4061.9837518138843
2025-05-14 21:49:48,054 - INFO - Sample index 491 flagged with score 4062.1097966450884
2025-05-14 21:49:48,054 - INFO - Sample index 492 flagged with score 4062.1097966450884
2025-05-14 21:49:48,054 - INFO - Sample index 509 flagged with score 4061.9837518138843
2025-05-14 21:49:48,054 - INFO - Sample index 511 flagged with score 4062.1097966450884
2025-05-14 21:49:48,054 - INFO - Sample index 512 flagged with score 4061.9837518138843
2025-05-14 21:49:48,054 - INFO - Sample index 513 flagged with score 4062.1097966450884
2025-05-14 21:49:48,054 - INFO - Sample index 515 flagged with score 4061.8577030713423
2025-05-14 21:49:48,054 - INFO - Sample index 517 flagged with score 4061.9837518138843
2025-05-14 21:49:48,054 - INFO - Sample index 518 flagged with score 4061.8577030713423
2025-05-14 21:49:48,054 - INFO - Sample index 519 flagged with score 4061.8577030713423
2025-05-14 21:49:48,054 - INFO - Sample index 520 flagged with score 4061.7316504170976
2025-05-14 21:49:48,054 - INFO - Sample index 521 flagged with score 4061.8577030713423
2025-05-14 21:49:48,054 - INFO - Sample index 522 flagged with score 4061.9837518138843
2025-05-14 21:49:48,054 - INFO - Sample index 523 flagged with score 4061.7316504170976
2025-05-14 21:49:48,054 - INFO - Sample index 524 flagged with score 4061.7316504170976
2025-05-14 21:49:48,054 - INFO - Sample index 525 flagged with score 4061.7316504170976
2025-05-14 21:49:48,054 - INFO - Sample index 526 flagged with score 4061.9837518138843
2025-05-14 21:49:48,054 - INFO - Sample index 527 flagged with score 4061.9837518138843
2025-05-14 21:49:48,054 - INFO - Sample index 528 flagged with score 4062.1097966450884
2025-05-14 21:49:48,054 - INFO - Sample index 529 flagged with score 4061.7316504170976
2025-05-14 21:49:48,054 - INFO - Sample index 530 flagged with score 4061.9837518138843
2025-05-14 21:49:48,054 - INFO - Sample index 531 flagged with score 4061.9837518138843
2025-05-14 21:49:48,054 - INFO - Sample index 542 flagged with score 665.1075101064489
2025-05-14 21:49:48,054 - INFO - Sample index 551 flagged with score 1390.4359028736276
2025-05-14 21:49:48,054 - INFO - Sample index 553 flagged with score 1299.058120331804
2025-05-14 21:49:48,054 - INFO - Sample index 555 flagged with score 1241.0060434985803
2025-05-14 21:49:48,054 - INFO - Sample index 557 flagged with score 4061.9837518138843
2025-05-14 21:49:48,054 - INFO - Sample index 558 flagged with score 4061.8577030713423
2025-05-14 21:49:48,054 - INFO - Sample index 559 flagged with score 667.4129156676547
2025-05-14 21:49:48,054 - INFO - Sample index 560 flagged with score 4061.8577030713423
2025-05-14 21:49:48,054 - INFO - Sample index 561 flagged with score 3547.817357193011
2025-05-14 21:49:48,054 - INFO - Sample index 562 flagged with score 2042.7432535685928
2025-05-14 21:49:48,054 - INFO - Sample index 563 flagged with score 2815.4544926174885
2025-05-14 21:49:48,054 - INFO - Sample index 564 flagged with score 770.6620530427069
2025-05-14 21:49:48,054 - INFO - Sample index 565 flagged with score 970.6080568385985
2025-05-14 21:49:48,054 - INFO - Sample index 566 flagged with score 736.0
2025-05-14 21:49:48,054 - INFO - Sample index 567 flagged with score 676.5559843797112
2025-05-14 21:49:48,054 - INFO - Sample index 570 flagged with score 701.8147903827619
2025-05-14 21:49:48,054 - INFO - Sample index 578 flagged with score 803.1936254727125
2025-05-14 21:49:48,054 - INFO - Sample index 585 flagged with score 1071.8805903644304
2025-05-14 21:49:48,054 - INFO - Sample index 591 flagged with score 1003.2905860218165
2025-05-14 21:49:48,054 - INFO - Sample index 598 flagged with score 1069.9682238272312
2025-05-14 21:49:48,054 - INFO - Sample index 617 flagged with score 1135.436479949451
2025-05-14 21:49:48,054 - INFO - Sample index 638 flagged with score 1797.7052038640818
2025-05-14 21:49:48,054 - INFO - Sample index 639 flagged with score 1868.0984984737822
2025-05-14 21:49:48,054 - INFO - Sample index 640 flagged with score 1433.2285232997563
2025-05-14 21:49:48,054 - INFO - Sample index 641 flagged with score 1797.7052038640818
2025-05-14 21:49:48,054 - INFO - Sample index 642 flagged with score 1132.2755848290644
2025-05-14 21:49:48,054 - INFO - Sample index 647 flagged with score 1917.331478904991
2025-05-14 21:49:48,054 - INFO - Sample index 657 flagged with score 1365.1666564928987
2025-05-14 21:49:48,054 - INFO - Sample index 663 flagged with score 1233.5574571133684
2025-05-14 21:49:48,054 - INFO - Sample index 664 flagged with score 1299.058120331804
2025-05-14 21:49:48,054 - INFO - Sample index 667 flagged with score 1829.885242303462
2025-05-14 21:49:48,054 - INFO - Sample index 680 flagged with score 1481.7071235571489
2025-05-14 21:49:48,054 - INFO - Sample index 681 flagged with score 3096.237716972003
2025-05-14 21:49:48,054 - INFO - Sample index 682 flagged with score 2370.161175954074
2025-05-14 21:49:48,055 - INFO - Sample index 697 flagged with score 3219.778874394948
2025-05-14 21:49:48,055 - INFO - Sample index 699 flagged with score 3279.3365182609728
2025-05-14 21:49:48,055 - INFO - Sample index 707 flagged with score 1112.201420606897
2025-05-14 21:49:48,055 - INFO - Sample index 820 flagged with score 2901421966.065669
2025-05-14 21:49:48,055 - INFO - Sample index 821 flagged with score 2901421966.065649
2025-05-14 21:49:48,055 - INFO - Sample index 822 flagged with score 2901421966.0668354
2025-05-14 21:49:48,055 - INFO - Sample index 823 flagged with score 2901421966.0667386
2025-05-14 21:49:48,055 - INFO - Sample index 838 flagged with score 668.1796165702752
2025-05-14 21:49:48,055 - INFO - Sample index 846 flagged with score 1436.7964365211935
2025-05-14 21:49:48,055 - INFO - Sample index 847 flagged with score 1344.0
2025-05-14 21:49:48,055 - INFO - Sample index 849 flagged with score 1199.0396156924924
2025-05-14 21:49:48,055 - INFO - Sample index 851 flagged with score 1188.7472397444294
2025-05-14 21:49:48,055 - INFO - Sample index 987 flagged with score 1091.7582149908467
2025-05-14 21:49:48,055 - INFO - Model training completed
2025-05-14 21:49:48,055 - INFO - Initializing Isolation Forest and starting training
2025-05-14 21:49:48,125 - INFO - Isolation Forest predicted 107 anomalies out of 1065
2025-05-14 21:49:48,125 - INFO - Initializing ECOD and starting training
2025-05-14 21:49:48,130 - INFO - ECOD predicted 107 anomalies out of 1065
2025-05-14 21:49:48,130 - INFO - Initializing COPOD and starting training
2025-05-14 21:49:48,135 - INFO - COPOD predicted 107 anomalies out of 1065
2025-05-14 21:49:48,135 - INFO - Starting anomaly predictions
2025-05-14 21:49:48,160 - INFO - Predictions array (0 normal, 1 anomaly): [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
2025-05-14 21:49:48,160 - INFO - Predicted anomalies for 82 out of 1065 samples
2025-05-14 21:49:48,160 - INFO - Returning 82 anomaly indices
2025-05-14 21:49:48,160 - INFO - Anomaly details with scores: [{'index': 95, 'knn_score': 593.511583711725, 'iforest_score': -0.03528490663583106, 'ecod_score': 13.8217807265416, 'copod_score': 12.579223324584413}, {'index': 263, 'knn_score': 738.084006058931, 'iforest_score': -0.004566754106664739, 'ecod_score': 14.542674844286768, 'copod_score': 13.804621380023347}, {'index': 265, 'knn_score': 2121.6748101440994, 'iforest_score': 0.008050441785588003, 'ecod_score': 16.68458495357242, 'copod_score': 14.544106697079993}, {'index': 266, 'knn_score': 1927.4522043360764, 'iforest_score': -0.020222596950046356, 'ecod_score': 17.712877438162863, 'copod_score': 14.925543372318732}, {'index': 270, 'knn_score': 1918.3993327771984, 'iforest_score': -0.012081356295528534, 'ecod_score': 15.243035798683803, 'copod_score': 14.366488415098765}, {'index': 272, 'knn_score': 1174.8838240438924, 'iforest_score': -0.012784268064891413, 'ecod_score': 15.712885134058093, 'copod_score': 14.540731221568622}, {'index': 281, 'knn_score': 1745.1005701678055, 'iforest_score': -0.13900134276502596, 'ecod_score': 12.319062387256164, 'copod_score': 10.951764007609034}, {'index': 282, 'knn_score': 1612.7492055493315, 'iforest_score': -0.1523542570777101, 'ecod_score': 11.467051071345463, 'copod_score': 9.358837922641985}, {'index': 283, 'knn_score': 1678.704262221312, 'iforest_score': -0.15231955405558395, 'ecod_score': 11.314541156047127, 'copod_score': 9.9472427764}, {'index': 284, 'knn_score': 1546.6298846201053, 'iforest_score': -0.1511950039721553, 'ecod_score': 12.143788221098106, 'copod_score': 9.681361887440913}, {'index': 289, 'knn_score': 1142.180371044784, 'iforest_score': 0.01837856819887196, 'ecod_score': 16.8901323650119, 'copod_score': 16.152078900748478}, {'index': 291, 'knn_score': 671.237662828897, 'iforest_score': -0.08534500354393765, 'ecod_score': 14.069028232175572, 'copod_score': 13.37723082829786}, {'index': 292, 'knn_score': 1216.8418138772188, 'iforest_score': 0.005625764636990271, 'ecod_score': 16.556783978358986, 'copod_score': 15.818730514095565}, {'index': 293, 'knn_score': 729.7122720634483, 'iforest_score': -0.11147515921106993, 'ecod_score': 11.38286555836887, 'copod_score': 9.835940218259474}, {'index': 294, 'knn_score': 1115.8781295464125, 'iforest_score': -0.10404592795174034, 'ecod_score': 13.833181875262461, 'copod_score': 12.465883495615335}, {'index': 483, 'knn_score': 6498.915601852358, 'iforest_score': 0.025318414200306893, 'ecod_score': 20.895925168181343, 'copod_score': 16.73153414528453}, {'index': 484, 'knn_score': 3791.020970662125, 'iforest_score': 8.050197756737099e-06, 'ecod_score': 19.97911325818508, 'copod_score': 16.327216374379226}, {'index': 485, 'knn_score': 5145.038775364089, 'iforest_score': 0.0026352264372697665, 'ecod_score': 21.05942405175248, 'copod_score': 16.632222518844195}, {'index': 486, 'knn_score': 3791.156024222691, 'iforest_score': 0.014484866064113033, 'ecod_score': 21.16160026275663, 'copod_score': 17.685396973046117}, {'index': 487, 'knn_score': 3810.419399488723, 'iforest_score': 0.023097205414190358, 'ecod_score': 21.497405135782405, 'copod_score': 18.199166329086836}, {'index': 488, 'knn_score': 3791.020970662125, 'iforest_score': -0.004334622471235727, 'ecod_score': 21.08908034713751, 'copod_score': 17.720953458578883}, {'index': 489, 'knn_score': 3791.156024222691, 'iforest_score': 0.004947710271477224, 'ecod_score': 22.114019310905494, 'copod_score': 18.930642402054193}, {'index': 490, 'knn_score': 4061.9837518138843, 'iforest_score': -0.0016247706919382265, 'ecod_score': 21.492750027821405, 'copod_score': 18.20808459492148}, {'index': 491, 'knn_score': 4062.1097966450884, 'iforest_score': -0.0008031379620035972, 'ecod_score': 22.768724064176915, 'copod_score': 19.585347155325614}, {'index': 492, 'knn_score': 4062.1097966450884, 'iforest_score': -1.2075296635161159e-05, 'ecod_score': 22.202173297695897, 'copod_score': 18.834046409137272}, {'index': 509, 'knn_score': 4061.9837518138843, 'iforest_score': 0.0420187392377398, 'ecod_score': 22.361021824834875, 'copod_score': 20.08802289028631}, {'index': 511, 'knn_score': 4062.1097966450884, 'iforest_score': 0.00618772068440987, 'ecod_score': 22.949905759910486, 'copod_score': 19.934465358854485}, {'index': 512, 'knn_score': 4061.9837518138843, 'iforest_score': 0.009504354437291695, 'ecod_score': 23.46878887150898, 'copod_score': 20.28541196265768}, {'index': 513, 'knn_score': 4062.1097966450884, 'iforest_score': 0.010042007964358945, 'ecod_score': 22.417624503386953, 'copod_score': 19.132959070487026}, {'index': 515, 'knn_score': 4061.8577030713423, 'iforest_score': 0.027763604613250115, 'ecod_score': 21.605471110481833, 'copod_score': 19.33247217593327}, {'index': 517, 'knn_score': 4061.9837518138843, 'iforest_score': 0.014542625874180093, 'ecod_score': 23.4898596565995, 'copod_score': 20.4744192555435}, {'index': 518, 'knn_score': 4061.8577030713423, 'iforest_score': 0.014529174650545706, 'ecod_score': 23.977040228857, 'copod_score': 20.8771247756644}, {'index': 519, 'knn_score': 4061.8577030713423, 'iforest_score': 0.0133426615029002, 'ecod_score': 23.118464029570053, 'copod_score': 19.75033714101143}, {'index': 520, 'knn_score': 4061.7316504170976, 'iforest_score': 0.02178320733056971, 'ecod_score': 24.938056594981315, 'copod_score': 21.754679686130018}, {'index': 521, 'knn_score': 4061.8577030713423, 'iforest_score': 0.014584953678351775, 'ecod_score': 23.471285404192795, 'copod_score': 20.10315851563417}, {'index': 522, 'knn_score': 4061.9837518138843, 'iforest_score': 0.02611864759302651, 'ecod_score': 23.887800348487545, 'copod_score': 20.519673459928917}, {'index': 523, 'knn_score': 4061.7316504170976, 'iforest_score': 0.01373835574922544, 'ecod_score': 24.46982916513684, 'copod_score': 21.286452256285536}, {'index': 524, 'knn_score': 4061.7316504170976, 'iforest_score': 0.029601271978241472, 'ecod_score': 24.287811605913248, 'copod_score': 21.00314617301332}, {'index': 525, 'knn_score': 4061.7316504170976, 'iforest_score': 0.03514103161171678, 'ecod_score': 24.75703853609081, 'copod_score': 21.55684815532748}, {'index': 526, 'knn_score': 4061.9837518138843, 'iforest_score': 0.022952392486157325, 'ecod_score': 25.519651289635515, 'copod_score': 22.336274380784214}, {'index': 527, 'knn_score': 4061.9837518138843, 'iforest_score': 0.040249306630889214, 'ecod_score': 26.858560208844086, 'copod_score': 23.393879145556845}, {'index': 528, 'knn_score': 4062.1097966450884, 'iforest_score': 0.04298417531519494, 'ecod_score': 25.261672189608877, 'copod_score': 21.977006756708953}, {'index': 529, 'knn_score': 4061.7316504170976, 'iforest_score': 0.0341813177935919, 'ecod_score': 26.07649315068821, 'copod_score': 22.893116241836914}, {'index': 530, 'knn_score': 4061.9837518138843, 'iforest_score': 0.04790858558874678, 'ecod_score': 25.61502129657803, 'copod_score': 22.2468944080194}, {'index': 531, 'knn_score': 4061.9837518138843, 'iforest_score': 0.04504320747170287, 'ecod_score': 26.549270706816674, 'copod_score': 23.365893797965374}, {'index': 557, 'knn_score': 4061.9837518138843, 'iforest_score': 0.07315908057668952, 'ecod_score': 24.9693711713008, 'copod_score': 22.69637223675224}, {'index': 558, 'knn_score': 4061.8577030713423, 'iforest_score': 0.06357917767601107, 'ecod_score': 25.93357039967597, 'copod_score': 23.305156322919398}, {'index': 559, 'knn_score': 667.4129156676547, 'iforest_score': -0.0880405161638197, 'ecod_score': 16.116151138328043, 'copod_score': 13.036908637520296}, {'index': 560, 'knn_score': 4061.8577030713423, 'iforest_score': 0.0767623304098014, 'ecod_score': 25.201774048027808, 'copod_score': 22.928775113479247}, {'index': 561, 'knn_score': 3547.817357193011, 'iforest_score': 0.06559378933311666, 'ecod_score': 26.83183362937114, 'copod_score': 23.860608881893814}, {'index': 562, 'knn_score': 2042.7432535685928, 'iforest_score': 0.07254592099976798, 'ecod_score': 27.570921954348652, 'copod_score': 24.387545045497355}, {'index': 563, 'knn_score': 2815.4544926174885, 'iforest_score': 0.07176754985633538, 'ecod_score': 26.283094839585857, 'copod_score': 23.082904458822533}, {'index': 564, 'knn_score': 770.6620530427069, 'iforest_score': 0.016321394121684096, 'ecod_score': 20.5314113748585, 'copod_score': 18.081413789434464}, {'index': 565, 'knn_score': 970.6080568385985, 'iforest_score': 0.09158970639380659, 'ecod_score': 27.492116858616598, 'copod_score': 24.308739949765297}, {'index': 566, 'knn_score': 736.0, 'iforest_score': -0.07272856496286001, 'ecod_score': 17.441705819227185, 'copod_score': 13.500639296734983}, {'index': 567, 'knn_score': 676.5559843797112, 'iforest_score': -0.08628380401490526, 'ecod_score': 16.28160493894987, 'copod_score': 13.20236243814212}, {'index': 570, 'knn_score': 701.8147903827619, 'iforest_score': -0.042819578420222215, 'ecod_score': 18.828268577860435, 'copod_score': 16.378270992436395}, {'index': 578, 'knn_score': 803.1936254727125, 'iforest_score': 0.008144863501641342, 'ecod_score': 20.527412902948456, 'copod_score': 18.077415317524416}, {'index': 585, 'knn_score': 1071.8805903644304, 'iforest_score': 0.021725642849279247, 'ecod_score': 21.559581494560973, 'copod_score': 19.109583909136933}, {'index': 591, 'knn_score': 1003.2905860218165, 'iforest_score': -0.06142242549611704, 'ecod_score': 17.651489399772053, 'copod_score': 14.572246898964305}, {'index': 598, 'knn_score': 1069.9682238272312, 'iforest_score': -0.060471801231624045, 'ecod_score': 17.867920559839234, 'copod_score': 14.788678059031488}, {'index': 617, 'knn_score': 1135.436479949451, 'iforest_score': -0.06080536875381176, 'ecod_score': 18.083088766590635, 'copod_score': 15.00384626578289}, {'index': 638, 'knn_score': 1797.7052038640818, 'iforest_score': -0.0479300066318008, 'ecod_score': 14.124355786884715, 'copod_score': 11.996509181700233}, {'index': 639, 'knn_score': 1868.0984984737822, 'iforest_score': -0.010213719706755331, 'ecod_score': 16.607527027327134, 'copod_score': 14.299077437260316}, {'index': 640, 'knn_score': 1433.2285232997563, 'iforest_score': -0.03408495818881874, 'ecod_score': 16.132122150382436, 'copod_score': 13.638922580608295}, {'index': 641, 'knn_score': 1797.7052038640818, 'iforest_score': 0.0021984638900963693, 'ecod_score': 17.72448845466344, 'copod_score': 15.416038864596622}, {'index': 642, 'knn_score': 1132.2755848290644, 'iforest_score': -0.054664778078988396, 'ecod_score': 16.246840144151818, 'copod_score': 13.938390554085002}, {'index': 647, 'knn_score': 1917.331478904991, 'iforest_score': -0.03778629666620925, 'ecod_score': 15.247203660401052, 'copod_score': 13.857788767502633}, {'index': 657, 'knn_score': 1365.1666564928987, 'iforest_score': -0.14623871954766376, 'ecod_score': 12.87409961305105, 'copod_score': 10.72353220623692}, {'index': 663, 'knn_score': 1233.5574571133684, 'iforest_score': -0.14223414177805466, 'ecod_score': 12.511986269642616, 'copod_score': 10.361418862828486}, {'index': 664, 'knn_score': 1299.058120331804, 'iforest_score': -0.14336087787259877, 'ecod_score': 13.602699734384679, 'copod_score': 10.357004373560487}, {'index': 667, 'knn_score': 1829.885242303462, 'iforest_score': 0.031362234263444644, 'ecod_score': 18.671407654476422, 'copod_score': 17.150085163046}, {'index': 680, 'knn_score': 1481.7071235571489, 'iforest_score': -0.06075693238871793, 'ecod_score': 15.667837119159868, 'copod_score': 14.146514627729445}, {'index': 681, 'knn_score': 3096.237716972003, 'iforest_score': 0.013186570128161046, 'ecod_score': 18.088444446952355, 'copod_score': 15.952208863945797}, {'index': 682, 'knn_score': 2370.161175954074, 'iforest_score': 0.0025629061506587947, 'ecod_score': 18.139395123438085, 'copod_score': 16.433322652300337}, {'index': 697, 'knn_score': 3219.778874394948, 'iforest_score': -0.11551163003522186, 'ecod_score': 13.35860254418042, 'copod_score': 11.20803513736629}, {'index': 699, 'knn_score': 3279.3365182609728, 'iforest_score': -0.10363242390994071, 'ecod_score': 14.67661321868448, 'copod_score': 12.52604581187035}, {'index': 820, 'knn_score': 2901421966.065669, 'iforest_score': -0.0015033373298515285, 'ecod_score': 22.301016103124937, 'copod_score': 20.91111273561094}, {'index': 821, 'knn_score': 2901421966.065649, 'iforest_score': -0.052504973496896756, 'ecod_score': 19.61653082492266, 'copod_score': 17.408482588851335}, {'index': 822, 'knn_score': 2901421966.0668354, 'iforest_score': 0.06562660587267544, 'ecod_score': 25.81208430411305, 'copod_score': 23.637182274743743}, {'index': 823, 'knn_score': 2901421966.0667386, 'iforest_score': -0.059360910568936165, 'ecod_score': 19.77348349178192, 'copod_score': 18.16045187779622}, {'index': 851, 'knn_score': 1188.7472397444294, 'iforest_score': 0.015278931301082488, 'ecod_score': 19.452923456253647, 'copod_score': 16.249281643294495}]
2025-05-14 21:49:48,160 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 21:55:58,752 - INFO - 日志系统已初始化
2025-05-14 21:56:06,163 - INFO - Incoming request: POST /ml/detect
2025-05-14 21:56:06,164 - INFO - Received file: traffic_0.csv
2025-05-14 21:56:06,171 - INFO - Loaded DataFrame with 1065 rows and 25 columns
2025-05-14 21:56:06,185 - INFO - Training KNN
2025-05-14 21:56:06,236 - INFO - KNN detected 82 anomalies
2025-05-14 21:56:06,236 - INFO - Training IForest
2025-05-14 21:56:06,306 - INFO - IForest detected 107 anomalies
2025-05-14 21:56:06,306 - INFO - Training ECOD
2025-05-14 21:56:06,494 - INFO - ECOD detected 107 anomalies
2025-05-14 21:56:06,494 - INFO - Training COPOD
2025-05-14 21:56:06,499 - INFO - COPOD detected 107 anomalies
2025-05-14 21:56:06,499 - INFO - Returning 82 anomaly indices
2025-05-14 21:56:06,499 - INFO - Anomaly details with scores: [{'index': 95, 'knn_score': 593.511583711725, 'iforest_score': -0.05002420968727683, 'ecod_score': 13.8217807265416, 'copod_score': 12.579223324584413}, {'index': 263, 'knn_score': 738.084006058931, 'iforest_score': -0.02371835362988628, 'ecod_score': 14.542674844286768, 'copod_score': 13.804621380023347}, {'index': 265, 'knn_score': 2121.6748101440994, 'iforest_score': -0.014341210806634308, 'ecod_score': 16.68458495357242, 'copod_score': 14.544106697079993}, {'index': 266, 'knn_score': 1927.4522043360764, 'iforest_score': -0.029852448176984736, 'ecod_score': 17.712877438162863, 'copod_score': 14.925543372318732}, {'index': 270, 'knn_score': 1918.3993327771984, 'iforest_score': -0.02091571115563573, 'ecod_score': 15.243035798683803, 'copod_score': 14.366488415098765}, {'index': 272, 'knn_score': 1174.8838240438924, 'iforest_score': -0.022697982830635954, 'ecod_score': 15.712885134058093, 'copod_score': 14.540731221568622}, {'index': 281, 'knn_score': 1745.1005701678055, 'iforest_score': -0.13909667472698373, 'ecod_score': 12.319062387256164, 'copod_score': 10.951764007609034}, {'index': 282, 'knn_score': 1612.7492055493315, 'iforest_score': -0.15826914049463536, 'ecod_score': 11.467051071345463, 'copod_score': 9.358837922641985}, {'index': 283, 'knn_score': 1678.704262221312, 'iforest_score': -0.16185541841020767, 'ecod_score': 11.314541156047127, 'copod_score': 9.9472427764}, {'index': 284, 'knn_score': 1546.6298846201053, 'iforest_score': -0.1542508843900291, 'ecod_score': 12.143788221098106, 'copod_score': 9.681361887440913}, {'index': 289, 'knn_score': 1142.180371044784, 'iforest_score': -0.016875013915936488, 'ecod_score': 16.8901323650119, 'copod_score': 16.152078900748478}, {'index': 291, 'knn_score': 671.237662828897, 'iforest_score': -0.10909840779718782, 'ecod_score': 14.069028232175572, 'copod_score': 13.37723082829786}, {'index': 292, 'knn_score': 1216.8418138772188, 'iforest_score': -0.02060502047953916, 'ecod_score': 16.556783978358986, 'copod_score': 15.818730514095565}, {'index': 293, 'knn_score': 729.7122720634483, 'iforest_score': -0.12602450820205657, 'ecod_score': 11.38286555836887, 'copod_score': 9.835940218259474}, {'index': 294, 'knn_score': 1115.8781295464125, 'iforest_score': -0.11414507364728627, 'ecod_score': 13.833181875262461, 'copod_score': 12.465883495615335}, {'index': 483, 'knn_score': 6498.915601852358, 'iforest_score': 0.02749652505689648, 'ecod_score': 20.895925168181343, 'copod_score': 16.73153414528453}, {'index': 484, 'knn_score': 3791.020970662125, 'iforest_score': 0.008645975796550798, 'ecod_score': 19.97911325818508, 'copod_score': 16.327216374379226}, {'index': 485, 'knn_score': 5145.038775364089, 'iforest_score': 0.008698575616924886, 'ecod_score': 21.05942405175248, 'copod_score': 16.632222518844195}, {'index': 486, 'knn_score': 3791.156024222691, 'iforest_score': 0.026302749537643666, 'ecod_score': 21.16160026275663, 'copod_score': 17.685396973046117}, {'index': 487, 'knn_score': 3810.419399488723, 'iforest_score': 0.03267950425459443, 'ecod_score': 21.497405135782405, 'copod_score': 18.199166329086836}, {'index': 488, 'knn_score': 3791.020970662125, 'iforest_score': 0.010805837208408775, 'ecod_score': 21.08908034713751, 'copod_score': 17.720953458578883}, {'index': 489, 'knn_score': 3791.156024222691, 'iforest_score': 0.022079350557212662, 'ecod_score': 22.114019310905494, 'copod_score': 18.930642402054193}, {'index': 490, 'knn_score': 4061.9837518138843, 'iforest_score': 0.01235574302598974, 'ecod_score': 21.492750027821405, 'copod_score': 18.20808459492148}, {'index': 491, 'knn_score': 4062.1097966450884, 'iforest_score': 0.01998944319170126, 'ecod_score': 22.768724064176915, 'copod_score': 19.585347155325614}, {'index': 492, 'knn_score': 4062.1097966450884, 'iforest_score': 0.006633499200470738, 'ecod_score': 22.202173297695897, 'copod_score': 18.834046409137272}, {'index': 509, 'knn_score': 4061.9837518138843, 'iforest_score': 0.03505600875717507, 'ecod_score': 22.361021824834875, 'copod_score': 20.08802289028631}, {'index': 511, 'knn_score': 4062.1097966450884, 'iforest_score': 0.023808284147211145, 'ecod_score': 22.949905759910486, 'copod_score': 19.934465358854485}, {'index': 512, 'knn_score': 4061.9837518138843, 'iforest_score': 0.026851580007774656, 'ecod_score': 23.46878887150898, 'copod_score': 20.28541196265768}, {'index': 513, 'knn_score': 4062.1097966450884, 'iforest_score': 0.016514950739292433, 'ecod_score': 22.417624503386953, 'copod_score': 19.132959070487026}, {'index': 515, 'knn_score': 4061.8577030713423, 'iforest_score': 0.03297133164796506, 'ecod_score': 21.605471110481833, 'copod_score': 19.33247217593327}, {'index': 517, 'knn_score': 4061.9837518138843, 'iforest_score': 0.03355111794679133, 'ecod_score': 23.4898596565995, 'copod_score': 20.4744192555435}, {'index': 518, 'knn_score': 4061.8577030713423, 'iforest_score': 0.028736393242582703, 'ecod_score': 23.977040228857, 'copod_score': 20.8771247756644}, {'index': 519, 'knn_score': 4061.8577030713423, 'iforest_score': 0.0213384489471381, 'ecod_score': 23.118464029570053, 'copod_score': 19.75033714101143}, {'index': 520, 'knn_score': 4061.7316504170976, 'iforest_score': 0.026949710477941036, 'ecod_score': 24.938056594981315, 'copod_score': 21.754679686130018}, {'index': 521, 'knn_score': 4061.8577030713423, 'iforest_score': 0.023262501448349848, 'ecod_score': 23.471285404192795, 'copod_score': 20.10315851563417}, {'index': 522, 'knn_score': 4061.9837518138843, 'iforest_score': 0.024575570146383785, 'ecod_score': 23.887800348487545, 'copod_score': 20.519673459928917}, {'index': 523, 'knn_score': 4061.7316504170976, 'iforest_score': 0.026056386874398485, 'ecod_score': 24.46982916513684, 'copod_score': 21.286452256285536}, {'index': 524, 'knn_score': 4061.7316504170976, 'iforest_score': 0.033423566753912115, 'ecod_score': 24.287811605913248, 'copod_score': 21.00314617301332}, {'index': 525, 'knn_score': 4061.7316504170976, 'iforest_score': 0.04310499345039098, 'ecod_score': 24.75703853609081, 'copod_score': 21.55684815532748}, {'index': 526, 'knn_score': 4061.9837518138843, 'iforest_score': 0.03683347400039172, 'ecod_score': 25.519651289635515, 'copod_score': 22.336274380784214}, {'index': 527, 'knn_score': 4061.9837518138843, 'iforest_score': 0.05339297301626045, 'ecod_score': 26.858560208844086, 'copod_score': 23.393879145556845}, {'index': 528, 'knn_score': 4062.1097966450884, 'iforest_score': 0.04646184368232387, 'ecod_score': 25.261672189608877, 'copod_score': 21.977006756708953}, {'index': 529, 'knn_score': 4061.7316504170976, 'iforest_score': 0.042416642595683784, 'ecod_score': 26.07649315068821, 'copod_score': 22.893116241836914}, {'index': 530, 'knn_score': 4061.9837518138843, 'iforest_score': 0.048237013507597126, 'ecod_score': 25.61502129657803, 'copod_score': 22.2468944080194}, {'index': 531, 'knn_score': 4061.9837518138843, 'iforest_score': 0.05675162671356582, 'ecod_score': 26.549270706816674, 'copod_score': 23.365893797965374}, {'index': 557, 'knn_score': 4061.9837518138843, 'iforest_score': 0.07313854447779111, 'ecod_score': 24.9693711713008, 'copod_score': 22.69637223675224}, {'index': 558, 'knn_score': 4061.8577030713423, 'iforest_score': 0.06370690600926587, 'ecod_score': 25.93357039967597, 'copod_score': 23.305156322919398}, {'index': 559, 'knn_score': 667.4129156676547, 'iforest_score': -0.07098548626649082, 'ecod_score': 16.116151138328043, 'copod_score': 13.036908637520296}, {'index': 560, 'knn_score': 4061.8577030713423, 'iforest_score': 0.08057291384104004, 'ecod_score': 25.201774048027808, 'copod_score': 22.928775113479247}, {'index': 561, 'knn_score': 3547.817357193011, 'iforest_score': 0.07087009987533299, 'ecod_score': 26.83183362937114, 'copod_score': 23.860608881893814}, {'index': 562, 'knn_score': 2042.7432535685928, 'iforest_score': 0.07581917678977901, 'ecod_score': 27.570921954348652, 'copod_score': 24.387545045497355}, {'index': 563, 'knn_score': 2815.4544926174885, 'iforest_score': 0.07875366947283358, 'ecod_score': 26.283094839585857, 'copod_score': 23.082904458822533}, {'index': 564, 'knn_score': 770.6620530427069, 'iforest_score': -0.0045789952190449235, 'ecod_score': 20.5314113748585, 'copod_score': 18.081413789434464}, {'index': 565, 'knn_score': 970.6080568385985, 'iforest_score': 0.08387164910894862, 'ecod_score': 27.492116858616598, 'copod_score': 24.308739949765297}, {'index': 566, 'knn_score': 736.0, 'iforest_score': -0.06362636476603362, 'ecod_score': 17.441705819227185, 'copod_score': 13.500639296734983}, {'index': 567, 'knn_score': 676.5559843797112, 'iforest_score': -0.06914713284700935, 'ecod_score': 16.28160493894987, 'copod_score': 13.20236243814212}, {'index': 570, 'knn_score': 701.8147903827619, 'iforest_score': -0.055863696631974824, 'ecod_score': 18.828268577860435, 'copod_score': 16.378270992436395}, {'index': 578, 'knn_score': 803.1936254727125, 'iforest_score': -0.021968078184194106, 'ecod_score': 20.527412902948456, 'copod_score': 18.077415317524416}, {'index': 585, 'knn_score': 1071.8805903644304, 'iforest_score': -0.001030787840689551, 'ecod_score': 21.559581494560973, 'copod_score': 19.109583909136933}, {'index': 591, 'knn_score': 1003.2905860218165, 'iforest_score': -0.04839227472159685, 'ecod_score': 17.651489399772053, 'copod_score': 14.572246898964305}, {'index': 598, 'knn_score': 1069.9682238272312, 'iforest_score': -0.04424536458379552, 'ecod_score': 17.867920559839234, 'copod_score': 14.788678059031488}, {'index': 617, 'knn_score': 1135.436479949451, 'iforest_score': -0.03770888647562953, 'ecod_score': 18.083088766590635, 'copod_score': 15.00384626578289}, {'index': 638, 'knn_score': 1797.7052038640818, 'iforest_score': -0.050438443533640576, 'ecod_score': 14.124355786884715, 'copod_score': 11.996509181700233}, {'index': 639, 'knn_score': 1868.0984984737822, 'iforest_score': -0.012740423682890523, 'ecod_score': 16.607527027327134, 'copod_score': 14.299077437260316}, {'index': 640, 'knn_score': 1433.2285232997563, 'iforest_score': -0.03985806758115806, 'ecod_score': 16.132122150382436, 'copod_score': 13.638922580608295}, {'index': 641, 'knn_score': 1797.7052038640818, 'iforest_score': -0.011723692251113915, 'ecod_score': 17.72448845466344, 'copod_score': 15.416038864596622}, {'index': 642, 'knn_score': 1132.2755848290644, 'iforest_score': -0.07017821692994836, 'ecod_score': 16.246840144151818, 'copod_score': 13.938390554085002}, {'index': 647, 'knn_score': 1917.331478904991, 'iforest_score': -0.034594467302882737, 'ecod_score': 15.247203660401052, 'copod_score': 13.857788767502633}, {'index': 657, 'knn_score': 1365.1666564928987, 'iforest_score': -0.15137201430313835, 'ecod_score': 12.87409961305105, 'copod_score': 10.72353220623692}, {'index': 663, 'knn_score': 1233.5574571133684, 'iforest_score': -0.14278794348313412, 'ecod_score': 12.511986269642616, 'copod_score': 10.361418862828486}, {'index': 664, 'knn_score': 1299.058120331804, 'iforest_score': -0.14664799055658484, 'ecod_score': 13.602699734384679, 'copod_score': 10.357004373560487}, {'index': 667, 'knn_score': 1829.885242303462, 'iforest_score': 0.013557859264153427, 'ecod_score': 18.671407654476422, 'copod_score': 17.150085163046}, {'index': 680, 'knn_score': 1481.7071235571489, 'iforest_score': -0.07490894257597541, 'ecod_score': 15.667837119159868, 'copod_score': 14.146514627729445}, {'index': 681, 'knn_score': 3096.237716972003, 'iforest_score': 0.009131050932978835, 'ecod_score': 18.088444446952355, 'copod_score': 15.952208863945797}, {'index': 682, 'knn_score': 2370.161175954074, 'iforest_score': 0.015762835148181553, 'ecod_score': 18.139395123438085, 'copod_score': 16.433322652300337}, {'index': 697, 'knn_score': 3219.778874394948, 'iforest_score': -0.10651345052970668, 'ecod_score': 13.35860254418042, 'copod_score': 11.20803513736629}, {'index': 699, 'knn_score': 3279.3365182609728, 'iforest_score': -0.10253050708916622, 'ecod_score': 14.67661321868448, 'copod_score': 12.52604581187035}, {'index': 820, 'knn_score': 2901421966.065669, 'iforest_score': 0.04296226134058845, 'ecod_score': 22.301016103124937, 'copod_score': 20.91111273561094}, {'index': 821, 'knn_score': 2901421966.065649, 'iforest_score': -0.012376266231562072, 'ecod_score': 19.61653082492266, 'copod_score': 17.408482588851335}, {'index': 822, 'knn_score': 2901421966.0668354, 'iforest_score': 0.09496884475346046, 'ecod_score': 25.81208430411305, 'copod_score': 23.637182274743743}, {'index': 823, 'knn_score': 2901421966.0667386, 'iforest_score': -0.006155425611246601, 'ecod_score': 19.77348349178192, 'copod_score': 18.16045187779622}, {'index': 851, 'knn_score': 1188.7472397444294, 'iforest_score': 0.016115018302532258, 'ecod_score': 19.452923456253647, 'copod_score': 16.249281643294495}]
2025-05-14 21:56:06,500 - INFO - Completed request: POST /ml/detect -> 200
2025-05-14 21:58:08,466 - INFO - 日志系统初始化完成
2025-05-14 21:58:14,089 - INFO - 收到请求：POST /ml/detect
2025-05-14 21:58:14,092 - INFO - 接收到文件：traffic_0.csv
2025-05-14 21:58:14,100 - INFO - 已加载 DataFrame，行数：1065，列数：25
2025-05-14 21:58:14,113 - INFO - 开始训练模型：KNN
2025-05-14 21:58:14,161 - INFO - 模型 KNN 检测到异常样本：82 条
2025-05-14 21:58:14,162 - INFO - 开始训练模型：IForest
2025-05-14 21:58:14,232 - INFO - 模型 IForest 检测到异常样本：107 条
2025-05-14 21:58:14,232 - INFO - 开始训练模型：ECOD
2025-05-14 21:58:14,426 - INFO - 模型 ECOD 检测到异常样本：107 条
2025-05-14 21:58:14,426 - INFO - 开始训练模型：COPOD
2025-05-14 21:58:14,430 - INFO - 模型 COPOD 检测到异常样本：107 条
2025-05-14 21:58:14,430 - INFO - 返回异常样本索引，共 82 条
2025-05-14 21:58:14,430 - INFO - 异常样本详情及分数：[{'index': 95, 'knn_score': 593.511583711725, 'iforest_score': -0.06429511451492648, 'ecod_score': 13.8217807265416, 'copod_score': 12.579223324584413}, {'index': 263, 'knn_score': 738.084006058931, 'iforest_score': -0.036600839208072666, 'ecod_score': 14.542674844286768, 'copod_score': 13.804621380023347}, {'index': 265, 'knn_score': 2121.6748101440994, 'iforest_score': 0.0032454272820562347, 'ecod_score': 16.68458495357242, 'copod_score': 14.544106697079993}, {'index': 266, 'knn_score': 1927.4522043360764, 'iforest_score': -0.032931470442307265, 'ecod_score': 17.712877438162863, 'copod_score': 14.925543372318732}, {'index': 270, 'knn_score': 1918.3993327771984, 'iforest_score': -0.02478867098386328, 'ecod_score': 15.243035798683803, 'copod_score': 14.366488415098765}, {'index': 272, 'knn_score': 1174.8838240438924, 'iforest_score': -0.0375500633699376, 'ecod_score': 15.712885134058093, 'copod_score': 14.540731221568622}, {'index': 281, 'knn_score': 1745.1005701678055, 'iforest_score': -0.14581299184400703, 'ecod_score': 12.319062387256164, 'copod_score': 10.951764007609034}, {'index': 282, 'knn_score': 1612.7492055493315, 'iforest_score': -0.15959001280051366, 'ecod_score': 11.467051071345463, 'copod_score': 9.358837922641985}, {'index': 283, 'knn_score': 1678.704262221312, 'iforest_score': -0.16132576651321517, 'ecod_score': 11.314541156047127, 'copod_score': 9.9472427764}, {'index': 284, 'knn_score': 1546.6298846201053, 'iforest_score': -0.15593409300579975, 'ecod_score': 12.143788221098106, 'copod_score': 9.681361887440913}, {'index': 289, 'knn_score': 1142.180371044784, 'iforest_score': 6.81018850099413e-05, 'ecod_score': 16.8901323650119, 'copod_score': 16.152078900748478}, {'index': 291, 'knn_score': 671.237662828897, 'iforest_score': -0.11481524642498492, 'ecod_score': 14.069028232175572, 'copod_score': 13.37723082829786}, {'index': 292, 'knn_score': 1216.8418138772188, 'iforest_score': -0.010456581128700515, 'ecod_score': 16.556783978358986, 'copod_score': 15.818730514095565}, {'index': 293, 'knn_score': 729.7122720634483, 'iforest_score': -0.1286963829376237, 'ecod_score': 11.38286555836887, 'copod_score': 9.835940218259474}, {'index': 294, 'knn_score': 1115.8781295464125, 'iforest_score': -0.11246566606032826, 'ecod_score': 13.833181875262461, 'copod_score': 12.465883495615335}, {'index': 483, 'knn_score': 6498.915601852358, 'iforest_score': 0.02567888723446654, 'ecod_score': 20.895925168181343, 'copod_score': 16.73153414528453}, {'index': 484, 'knn_score': 3791.020970662125, 'iforest_score': -0.003933703970924962, 'ecod_score': 19.97911325818508, 'copod_score': 16.327216374379226}, {'index': 485, 'knn_score': 5145.038775364089, 'iforest_score': 0.0019893281052775214, 'ecod_score': 21.05942405175248, 'copod_score': 16.632222518844195}, {'index': 486, 'knn_score': 3791.156024222691, 'iforest_score': 0.0029630827938320614, 'ecod_score': 21.16160026275663, 'copod_score': 17.685396973046117}, {'index': 487, 'knn_score': 3810.419399488723, 'iforest_score': -0.0027909253740632245, 'ecod_score': 21.497405135782405, 'copod_score': 18.199166329086836}, {'index': 488, 'knn_score': 3791.020970662125, 'iforest_score': -0.016472619165312063, 'ecod_score': 21.08908034713751, 'copod_score': 17.720953458578883}, {'index': 489, 'knn_score': 3791.156024222691, 'iforest_score': -0.0013895062557957027, 'ecod_score': 22.114019310905494, 'copod_score': 18.930642402054193}, {'index': 490, 'knn_score': 4061.9837518138843, 'iforest_score': -0.014295982368623172, 'ecod_score': 21.492750027821405, 'copod_score': 18.20808459492148}, {'index': 491, 'knn_score': 4062.1097966450884, 'iforest_score': -0.0008390183019679753, 'ecod_score': 22.768724064176915, 'copod_score': 19.585347155325614}, {'index': 492, 'knn_score': 4062.1097966450884, 'iforest_score': -0.00950525877169861, 'ecod_score': 22.202173297695897, 'copod_score': 18.834046409137272}, {'index': 509, 'knn_score': 4061.9837518138843, 'iforest_score': 0.03136219344420077, 'ecod_score': 22.361021824834875, 'copod_score': 20.08802289028631}, {'index': 511, 'knn_score': 4062.1097966450884, 'iforest_score': 0.020413239057249122, 'ecod_score': 22.949905759910486, 'copod_score': 19.934465358854485}, {'index': 512, 'knn_score': 4061.9837518138843, 'iforest_score': 0.014615688051815678, 'ecod_score': 23.46878887150898, 'copod_score': 20.28541196265768}, {'index': 513, 'knn_score': 4062.1097966450884, 'iforest_score': 0.002671544538406012, 'ecod_score': 22.417624503386953, 'copod_score': 19.132959070487026}, {'index': 515, 'knn_score': 4061.8577030713423, 'iforest_score': 0.016703230903314936, 'ecod_score': 21.605471110481833, 'copod_score': 19.33247217593327}, {'index': 517, 'knn_score': 4061.9837518138843, 'iforest_score': 0.026700492884638605, 'ecod_score': 23.4898596565995, 'copod_score': 20.4744192555435}, {'index': 518, 'knn_score': 4061.8577030713423, 'iforest_score': 0.031151018046193135, 'ecod_score': 23.977040228857, 'copod_score': 20.8771247756644}, {'index': 519, 'knn_score': 4061.8577030713423, 'iforest_score': 0.014305182426293639, 'ecod_score': 23.118464029570053, 'copod_score': 19.75033714101143}, {'index': 520, 'knn_score': 4061.7316504170976, 'iforest_score': 0.03502498293490952, 'ecod_score': 24.938056594981315, 'copod_score': 21.754679686130018}, {'index': 521, 'knn_score': 4061.8577030713423, 'iforest_score': 0.02302308785667939, 'ecod_score': 23.471285404192795, 'copod_score': 20.10315851563417}, {'index': 522, 'knn_score': 4061.9837518138843, 'iforest_score': 0.03246935015885677, 'ecod_score': 23.887800348487545, 'copod_score': 20.519673459928917}, {'index': 523, 'knn_score': 4061.7316504170976, 'iforest_score': 0.033412594773375215, 'ecod_score': 24.46982916513684, 'copod_score': 21.286452256285536}, {'index': 524, 'knn_score': 4061.7316504170976, 'iforest_score': 0.04228990095830942, 'ecod_score': 24.287811605913248, 'copod_score': 21.00314617301332}, {'index': 525, 'knn_score': 4061.7316504170976, 'iforest_score': 0.04518650940759217, 'ecod_score': 24.75703853609081, 'copod_score': 21.55684815532748}, {'index': 526, 'knn_score': 4061.9837518138843, 'iforest_score': 0.03711679291592074, 'ecod_score': 25.519651289635515, 'copod_score': 22.336274380784214}, {'index': 527, 'knn_score': 4061.9837518138843, 'iforest_score': 0.05378665373111691, 'ecod_score': 26.858560208844086, 'copod_score': 23.393879145556845}, {'index': 528, 'knn_score': 4062.1097966450884, 'iforest_score': 0.044739950529628314, 'ecod_score': 25.261672189608877, 'copod_score': 21.977006756708953}, {'index': 529, 'knn_score': 4061.7316504170976, 'iforest_score': 0.040570578389757084, 'ecod_score': 26.07649315068821, 'copod_score': 22.893116241836914}, {'index': 530, 'knn_score': 4061.9837518138843, 'iforest_score': 0.05348877651201589, 'ecod_score': 25.61502129657803, 'copod_score': 22.2468944080194}, {'index': 531, 'knn_score': 4061.9837518138843, 'iforest_score': 0.06452001310946787, 'ecod_score': 26.549270706816674, 'copod_score': 23.365893797965374}, {'index': 557, 'knn_score': 4061.9837518138843, 'iforest_score': 0.08469148790976988, 'ecod_score': 24.9693711713008, 'copod_score': 22.69637223675224}, {'index': 558, 'knn_score': 4061.8577030713423, 'iforest_score': 0.08050383287604412, 'ecod_score': 25.93357039967597, 'copod_score': 23.305156322919398}, {'index': 559, 'knn_score': 667.4129156676547, 'iforest_score': -0.05302136622412479, 'ecod_score': 16.116151138328043, 'copod_score': 13.036908637520296}, {'index': 560, 'knn_score': 4061.8577030713423, 'iforest_score': 0.09028837550106328, 'ecod_score': 25.201774048027808, 'copod_score': 22.928775113479247}, {'index': 561, 'knn_score': 3547.817357193011, 'iforest_score': 0.08588868674604966, 'ecod_score': 26.83183362937114, 'copod_score': 23.860608881893814}, {'index': 562, 'knn_score': 2042.7432535685928, 'iforest_score': 0.08847571202223115, 'ecod_score': 27.570921954348652, 'copod_score': 24.387545045497355}, {'index': 563, 'knn_score': 2815.4544926174885, 'iforest_score': 0.08103244096238804, 'ecod_score': 26.283094839585857, 'copod_score': 23.082904458822533}, {'index': 564, 'knn_score': 770.6620530427069, 'iforest_score': 0.013334850329041137, 'ecod_score': 20.5314113748585, 'copod_score': 18.081413789434464}, {'index': 565, 'knn_score': 970.6080568385985, 'iforest_score': 0.09324555384957167, 'ecod_score': 27.492116858616598, 'copod_score': 24.308739949765297}, {'index': 566, 'knn_score': 736.0, 'iforest_score': -0.05208092140632242, 'ecod_score': 17.441705819227185, 'copod_score': 13.500639296734983}, {'index': 567, 'knn_score': 676.5559843797112, 'iforest_score': -0.053355935311953095, 'ecod_score': 16.28160493894987, 'copod_score': 13.20236243814212}, {'index': 570, 'knn_score': 701.8147903827619, 'iforest_score': -0.030878227120895274, 'ecod_score': 18.828268577860435, 'copod_score': 16.378270992436395}, {'index': 578, 'knn_score': 803.1936254727125, 'iforest_score': 0.013072952509956992, 'ecod_score': 20.527412902948456, 'copod_score': 18.077415317524416}, {'index': 585, 'knn_score': 1071.8805903644304, 'iforest_score': 0.0269834893990627, 'ecod_score': 21.559581494560973, 'copod_score': 19.109583909136933}, {'index': 591, 'knn_score': 1003.2905860218165, 'iforest_score': -0.03502585260203661, 'ecod_score': 17.651489399772053, 'copod_score': 14.572246898964305}, {'index': 598, 'knn_score': 1069.9682238272312, 'iforest_score': -0.03554613590631872, 'ecod_score': 17.867920559839234, 'copod_score': 14.788678059031488}, {'index': 617, 'knn_score': 1135.436479949451, 'iforest_score': -0.03525094716944022, 'ecod_score': 18.083088766590635, 'copod_score': 15.00384626578289}, {'index': 638, 'knn_score': 1797.7052038640818, 'iforest_score': -0.049430678601819544, 'ecod_score': 14.124355786884715, 'copod_score': 11.996509181700233}, {'index': 639, 'knn_score': 1868.0984984737822, 'iforest_score': 0.003743215843620029, 'ecod_score': 16.607527027327134, 'copod_score': 14.299077437260316}, {'index': 640, 'knn_score': 1433.2285232997563, 'iforest_score': -0.03951457514213952, 'ecod_score': 16.132122150382436, 'copod_score': 13.638922580608295}, {'index': 641, 'knn_score': 1797.7052038640818, 'iforest_score': 0.01099743742350412, 'ecod_score': 17.72448845466344, 'copod_score': 15.416038864596622}, {'index': 642, 'knn_score': 1132.2755848290644, 'iforest_score': -0.05975002928501283, 'ecod_score': 16.246840144151818, 'copod_score': 13.938390554085002}, {'index': 647, 'knn_score': 1917.331478904991, 'iforest_score': -0.03922077112932765, 'ecod_score': 15.247203660401052, 'copod_score': 13.857788767502633}, {'index': 657, 'knn_score': 1365.1666564928987, 'iforest_score': -0.153956812013766, 'ecod_score': 12.87409961305105, 'copod_score': 10.72353220623692}, {'index': 663, 'knn_score': 1233.5574571133684, 'iforest_score': -0.15015280574761258, 'ecod_score': 12.511986269642616, 'copod_score': 10.361418862828486}, {'index': 664, 'knn_score': 1299.058120331804, 'iforest_score': -0.15276418569679268, 'ecod_score': 13.602699734384679, 'copod_score': 10.357004373560487}, {'index': 667, 'knn_score': 1829.885242303462, 'iforest_score': 0.042818896988702226, 'ecod_score': 18.671407654476422, 'copod_score': 17.150085163046}, {'index': 680, 'knn_score': 1481.7071235571489, 'iforest_score': -0.0850168964160305, 'ecod_score': 15.667837119159868, 'copod_score': 14.146514627729445}, {'index': 681, 'knn_score': 3096.237716972003, 'iforest_score': 0.013862520965161829, 'ecod_score': 18.088444446952355, 'copod_score': 15.952208863945797}, {'index': 682, 'knn_score': 2370.161175954074, 'iforest_score': 0.0041291519827025835, 'ecod_score': 18.139395123438085, 'copod_score': 16.433322652300337}, {'index': 697, 'knn_score': 3219.778874394948, 'iforest_score': -0.12189823894280977, 'ecod_score': 13.35860254418042, 'copod_score': 11.20803513736629}, {'index': 699, 'knn_score': 3279.3365182609728, 'iforest_score': -0.11194014035736038, 'ecod_score': 14.67661321868448, 'copod_score': 12.52604581187035}, {'index': 820, 'knn_score': 2901421966.065669, 'iforest_score': -0.0019860946309561145, 'ecod_score': 22.301016103124937, 'copod_score': 20.91111273561094}, {'index': 821, 'knn_score': 2901421966.065649, 'iforest_score': -0.04923627802402103, 'ecod_score': 19.61653082492266, 'copod_score': 17.408482588851335}, {'index': 822, 'knn_score': 2901421966.0668354, 'iforest_score': 0.05024872733805974, 'ecod_score': 25.81208430411305, 'copod_score': 23.637182274743743}, {'index': 823, 'knn_score': 2901421966.0667386, 'iforest_score': -0.05833956587541489, 'ecod_score': 19.77348349178192, 'copod_score': 18.16045187779622}, {'index': 851, 'knn_score': 1188.7472397444294, 'iforest_score': 0.020460602662001226, 'ecod_score': 19.452923456253647, 'copod_score': 16.249281643294495}]
2025-05-14 21:58:14,431 - INFO - 请求完成：POST /ml/detect -> 状态码 200
2025-05-14 22:02:48,293 - INFO - 日志系统初始化完成
2025-05-14 23:41:00,740 - INFO - 日志系统初始化完成
2025-05-15 06:36:34,168 - INFO - 日志系统初始化完成
2025-05-15 06:37:33,388 - INFO - 日志系统初始化完成
2025-05-15 06:41:56,138 - INFO - 日志系统初始化完成
2025-05-15 06:42:40,918 - INFO - 日志系统初始化完成
2025-05-15 06:45:36,135 - INFO - 日志系统初始化完成
2025-05-15 06:54:33,001 - INFO - 日志系统初始化完成
2025-05-15 07:37:26,211 - INFO - 日志系统初始化完成
2025-05-15 07:38:48,921 - INFO - 日志系统初始化完成
2025-05-15 07:54:11,164 - INFO - 日志系统初始化完成
2025-05-15 07:54:21,087 - INFO - 日志系统初始化完成
2025-05-15 07:54:29,685 - INFO - 日志系统初始化完成
2025-05-15 07:54:39,179 - INFO - 日志系统初始化完成
2025-05-15 07:54:44,966 - INFO - 日志系统初始化完成
2025-05-15 07:54:54,083 - INFO - 日志系统初始化完成
2025-05-15 07:54:59,298 - INFO - 日志系统初始化完成
2025-05-15 07:55:05,695 - INFO - 日志系统初始化完成
2025-05-15 07:55:12,558 - INFO - 日志系统初始化完成
2025-05-15 07:56:31,493 - INFO - 日志系统初始化完成
2025-05-15 07:58:12,094 - INFO - 日志系统初始化完成
2025-05-15 08:02:28,147 - INFO - 日志系统初始化完成
2025-05-15 08:02:54,305 - INFO - 日志系统初始化完成
2025-05-15 08:03:11,222 - INFO - 日志系统初始化完成
2025-05-15 08:03:25,084 - INFO - 日志系统初始化完成
2025-05-15 08:04:34,558 - INFO - 日志系统初始化完成
2025-05-15 08:04:47,792 - INFO - 日志系统初始化完成
2025-05-15 08:09:09,550 - INFO - 日志系统初始化完成
2025-05-15 08:17:31,684 - INFO - 日志系统初始化完成
2025-05-15 08:20:35,945 - INFO - 日志系统初始化完成
2025-05-15 08:23:03,903 - INFO - 日志系统初始化完成
2025-05-15 08:23:57,022 - INFO - 日志系统初始化完成
2025-05-15 08:24:08,883 - INFO - 日志系统初始化完成
2025-05-15 08:24:14,745 - INFO - 日志系统初始化完成
2025-05-15 08:25:28,731 - INFO - 日志系统初始化完成
2025-05-15 08:27:39,042 - INFO - 日志系统初始化完成
2025-05-15 08:28:01,415 - INFO - 日志系统初始化完成
2025-05-15 08:32:03,464 - INFO - 日志系统初始化完成
2025-05-15 08:33:03,421 - INFO - 日志系统初始化完成
2025-05-15 08:33:41,944 - INFO - 日志系统初始化完成
2025-05-15 08:43:29,051 - INFO - 日志系统初始化完成
2025-05-15 08:45:59,758 - INFO - 日志系统初始化完成
2025-05-15 09:35:44,030 - INFO - 日志系统初始化完成
2025-05-15 09:36:56,172 - INFO - 日志系统初始化完成
2025-05-18 22:21:33,479 - INFO - 日志系统初始化完成
2025-05-21 21:58:11,314 - INFO - 日志系统初始化完成
2025-05-21 22:50:45,872 - INFO - 日志系统初始化完成
2025-05-21 22:58:48,711 - INFO - 日志系统初始化完成
2025-05-21 23:02:02,660 - INFO - 日志系统初始化完成
2025-05-21 23:02:11,972 - INFO - 日志系统初始化完成
2025-05-21 23:02:35,836 - INFO - 日志系统初始化完成
2025-05-21 23:08:13,776 - INFO - 收到请求：POST /ml/detect
2025-05-21 23:08:13,780 - INFO - 接收到文件：traffic_0.csv
2025-05-21 23:08:13,791 - INFO - 已加载 DataFrame，行数：20，列数：23
2025-05-21 23:08:13,820 - INFO - 开始训练模型：KNN
2025-05-21 23:08:13,826 - INFO - 模型 KNN 检测到异常样本：1 条
2025-05-21 23:08:13,826 - INFO - 开始训练模型：IForest
2025-05-21 23:08:13,899 - INFO - 模型 IForest 检测到异常样本：2 条
2025-05-21 23:08:13,899 - INFO - 开始训练模型：ECOD
2025-05-21 23:08:14,133 - INFO - 模型 ECOD 检测到异常样本：2 条
2025-05-21 23:08:14,133 - INFO - 开始训练模型：COPOD
2025-05-21 23:08:14,134 - INFO - 模型 COPOD 检测到异常样本：2 条
2025-05-21 23:08:14,135 - INFO - 返回异常样本索引，共 1 条
2025-05-21 23:08:14,135 - INFO - 异常样本详情及分数：[{'index': 4, 'knn_score': 758688941.3181945, 'iforest_score': 0.04989663103618325, 'ecod_score': 16.549359451888122, 'copod_score': 14.85822936156692}]
2025-05-21 23:08:14,136 - INFO - 请求完成：POST /ml/detect -> 状态码 200
